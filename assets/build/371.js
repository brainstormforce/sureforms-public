"use strict";(self.webpackChunksureforms=self.webpackChunksureforms||[]).push([[371],{8578:function(e,t,i){i.d(t,{o:function(){return s}});var n=i(6046),s=function(e,t,i){void 0===i&&(i=!0);var s="Function"===e.constructor.name?e.prototype:e,o=s.componentWillLoad;s.componentWillLoad=function(){var e,s=this,c=(0,n.g)(this),l={promise:new Promise((function(t){e=t})),resolve:e},a=new CustomEvent("openWormhole",{bubbles:!0,composed:!0,detail:{consumer:this,fields:t,updater:function(e,t){(e in c?c:s)[e]=t},onOpen:l}});c.dispatchEvent(a);var h=function(){if(o)return o.call(s)};return i?l.promise.then((function(){return h()})):h()}}},371:function(e,t,i){i.r(t),i.d(t,{sc_donation_choices:function(){return c}});var n=i(6046),s=i(290),o=i(8578);i(5115);const c=class{constructor(e){(0,n.r)(this,e),this.scRemoveLineItem=(0,n.c)(this,"scRemoveLineItem",7),this.scUpdateLineItem=(0,n.c)(this,"scUpdateLineItem",7),this.scAddLineItem=(0,n.c)(this,"scAddLineItem",7),this.currencyCode="usd",this.lineItems=[],this.removeInvalid=!0}async reportValidity(){return!this.input||this.input.shadowRoot.querySelector("sc-input").reportValidity()}handleChange(){const e=Array.from(this.getChoices()).find((e=>e.checked));this.showCustomAmount="ad_hoc"===e.value,isNaN(parseInt(e.value))||this.scUpdateLineItem.emit({price_id:this.priceId,quantity:1,ad_hoc_amount:parseInt(e.value)})}handleCustomAmountToggle(e){e&&setTimeout((()=>{this.input.triggerFocus()}),50)}handleLineItemsChange(){var e;(null===(e=this.lineItems)||void 0===e?void 0:e.length)&&(this.lineItem=(this.lineItems||[]).find((e=>e.price.id===this.priceId)))}handleLineItemChange(e){this.removeInvalid&&this.removeInvalidPrices();const t=this.getChoices();let i=!1;t.forEach((t=>{isNaN(parseInt(t.value))||t.disabled||(parseInt(t.value)===(null==e?void 0:e.ad_hoc_amount)?(t.checked=!0,i=!0):t.checked=!1)})),this.showCustomAmount=!i,i||(this.el.querySelector('sc-choice[value="ad_hoc"]').checked=!0)}componentDidLoad(){this.handleLineItemsChange()}selectDefaultChoice(){const e=this.getChoices();e.length&&(e[0].checked=!0)}getChoices(){return this.el.querySelectorAll("sc-choice")}removeInvalidPrices(){var e,t,i;this.lineItem&&((null===(e=this.lineItem.price)||void 0===e?void 0:e.ad_hoc_min_amount)||(null===(i=null===(t=this.lineItem)||void 0===t?void 0:t.price)||void 0===i?void 0:i.ad_hoc_min_amount))&&this.el.querySelectorAll("sc-choice").forEach((e=>{var t,i,n,s;parseInt(e.value)>(null===(i=null===(t=this.lineItem)||void 0===t?void 0:t.price)||void 0===i?void 0:i.ad_hoc_max_amount)||parseInt(e.value)<(null===(s=null===(n=this.lineItem)||void 0===n?void 0:n.price)||void 0===s?void 0:s.ad_hoc_min_amount)?(e.style.display="none",e.disabled=!0):(e.style.display="flex",e.disabled=!1)}))}updateCustomAmount(){var e;this.input.value!==(null===(e=this.lineItem)||void 0===e?void 0:e.ad_hoc_amount.toString())&&(this.input.value?this.scUpdateLineItem.emit({price_id:this.priceId,quantity:1,ad_hoc_amount:parseInt(this.input.value)}):this.scRemoveLineItem.emit({price_id:this.priceId,quantity:1}))}render(){var e;return this.loading?(0,n.h)("div",{class:"sc-donation-choices"},(0,n.h)("sc-skeleton",{style:{width:"20%",display:"inline-block"}}),(0,n.h)("sc-skeleton",{style:{width:"60%",display:"inline-block"}}),(0,n.h)("sc-skeleton",{style:{width:"40%",display:"inline-block"}})):(0,n.h)("div",{class:"sc-donation-choices"},(0,n.h)("sc-choices",{label:this.label,"auto-width":!0},(0,n.h)("slot",null)),this.showCustomAmount&&(0,n.h)("div",{class:"sc-donation-choices__form"},(0,n.h)("sc-price-input",{ref:e=>this.input=e,required:!0,currencyCode:this.currencyCode,label:"Enter an amount",value:null===(e=this.lineItem)||void 0===e?void 0:e.ad_hoc_amount.toString()}),(0,n.h)("sc-button",{type:"primary",onClick:()=>this.updateCustomAmount(),full:!0,busy:this.busy},(0,s._)("Update","surecart"))),this.busy&&(0,n.h)("sc-block-ui",{style:{zIndex:"9"}}))}get el(){return(0,n.g)(this)}static get watchers(){return{showCustomAmount:["handleCustomAmountToggle"],lineItems:["handleLineItemsChange"],lineItem:["handleLineItemChange"]}}};(0,o.o)(c,["lineItems","loading","busy","currencyCode"],!1),c.style=":host{display:block}.sc-donation-choices{display:grid;gap:var(--sc-spacing-small);position:relative}.sc-donation-choices__form{display:grid;gap:var(--sc-spacing-small)}"}}]);