"use strict";(self.webpackChunksureforms=self.webpackChunksureforms||[]).push([[3106],{3106:function(t,e,i){i.r(e),i.d(e,{sc_checkout:function(){return n}});var s=i(7492),r=i(9988),o=i(8301);i(7094);const n=class{constructor(t){(0,s.r)(this,t),this.scOrderUpdated=(0,s.c)(this,"scOrderUpdated",7),this.scOrderFinalized=(0,s.c)(this,"scOrderFinalized",7),this.scOrderError=(0,s.c)(this,"scOrderError",7),this.prices=[],this.mode="live",this.currencyCode="usd",this.persistSession=!0,this.successUrl="",this.editLineItems=!0,this.removeLineItems=!0,this.stripePaymentElement=!1,this.pricesEntities={},this.productsEntities={},this.checkoutState="idle",this.processor="stripe",this.paymentIntents={}}handleSetPaymentIntent(t){var e,i;const s=null===(e=t.detail)||void 0===e?void 0:e.payment_intent,r=null===(i=t.detail)||void 0===i?void 0:i.processor;this.paymentIntents[r]=s}handleProcessorChange(t){this.processor=t.detail}handleAddEntities(t){const{products:e,prices:i}=t.detail;Object.keys((null==e?void 0:e.length)||{})&&(this.productsEntities={...this.productsEntities,...e}),Object.keys((null==i?void 0:i.length)||{})&&(this.pricesEntities={...this.pricesEntities,...i})}async submit({skip_validation:t}={skip_validation:!1}){return t||await this.validate(),await this.sessionProvider.finalize()}async validate(){const t=this.el.querySelector("sc-form");return await t.validate()}componentWillLoad(){o.U.create(this,this.state())}componentDidLoad(){this.isDuplicate=document.querySelector("sc-checkout")!==this.el}state(){var t,e,i,s,r,o,n,c,d,a,l,h,u,p;return{processor:this.processor,processors:this.processors,processor_data:null===(t=this.order)||void 0===t?void 0:t.processor_data,state:this.checkoutState,paymentIntents:this.paymentIntents,successUrl:this.successUrl,order:this.order,shippingEnabled:null===(e=this.order)||void 0===e?void 0:e.shipping_enabled,lineItems:(null===(s=null===(i=this.order)||void 0===i?void 0:i.line_items)||void 0===s?void 0:s.data)||[],editLineItems:this.editLineItems,removeLineItems:this.removeLineItems,loading:"loading"===this.checkoutState,busy:["updating","finalizing","paid","confirmed"].includes(this.checkoutState),paying:["finalizing","paid","confirmed"].includes(this.checkoutState),empty:!["loading","updating"].includes(this.checkoutState)&&!(null===(n=null===(o=null===(r=this.order)||void 0===r?void 0:r.line_items)||void 0===o?void 0:o.pagination)||void 0===n?void 0:n.count),stripePaymentElement:this.stripePaymentElement,error:this.error,customer:this.customer,tax_status:null===(c=null==this?void 0:this.order)||void 0===c?void 0:c.tax_status,customerShippingAddress:"string"!=typeof(null===(d=this.order)||void 0===d?void 0:d.customer)?null===(l=null===(a=null==this?void 0:this.order)||void 0===a?void 0:a.customer)||void 0===l?void 0:l.shipping_address:{},shippingAddress:null===(h=this.order)||void 0===h?void 0:h.shipping_address,taxStatus:null===(u=this.order)||void 0===u?void 0:u.tax_status,taxIdentifier:null===(p=this.order)||void 0===p?void 0:p.tax_identifier,lockedChoices:this.prices,products:this.productsEntities,prices:this.pricesEntities,country:"US",loggedIn:this.loggedIn,formId:this.formId,mode:this.mode,currencyCode:this.currencyCode}}render(){return this.isDuplicate?(0,s.h)("sc-alert",{open:!0},(0,r._)("Due to processor restrictions, only one checkout form is allowed on the page.","surecart")):(0,s.h)("div",{class:{"sc-checkout-container":!0,"sc-align-center":"center"===this.alignment,"sc-align-wide":"wide"===this.alignment,"sc-align-full":"full"===this.alignment}},(0,s.h)(o.U.Provider,{state:this.state()},(0,s.h)("sc-form-state-provider",{onScSetCheckoutFormState:t=>this.checkoutState=t.detail},(0,s.h)("sc-form-error-provider",{order:this.order,onScUpdateError:t=>this.error=t.detail},(0,s.h)("sc-form-components-validator",{order:this.order,disabled:this.disableComponentsValidation,taxEnabled:this.taxEnabled},(0,s.h)("sc-session-provider",{ref:t=>this.sessionProvider=t,order:this.order,prices:this.prices,stripePaymentElement:this.stripePaymentElement,paymentIntents:this.paymentIntents,persist:this.persistSession,modified:this.modified,mode:this.mode,"form-id":this.formId,"group-id":this.el.id,processor:this.processor,"currency-code":this.currencyCode,onScUpdateOrderState:t=>this.order=t.detail,onScError:t=>this.error=t.detail},(0,s.h)("sc-order-redirect-provider",{order:this.order,"success-url":this.successUrl},(0,s.h)("sc-order-confirm-provider",{order:this.order},(0,s.h)("slot",null))))))),this.state().busy&&(0,s.h)("sc-block-ui",{"z-index":9})))}get el(){return(0,s.g)(this)}};n.style="sc-checkout{display:block;font-family:var(--sc-font-sans);font-size:var(--sc-checkout-font-size, 16px);position:relative}sc-checkout h3{font-size:var(--sc-input-label-font-size-medium)}sc-alert{margin-bottom:var(--sc-form-row-spacing)}.sc-checkout-container.sc-align-center{max-width:500px;margin-left:auto;margin-right:auto}.sc-checkout-container.sc-align-wide{max-width:800px;margin-left:auto;margin-right:auto}::slotted(*){font-family:var(--sc-font-sans)}"},8301:function(t,e,i){i.d(e,{U:function(){return n}});var s=i(7492),r=new Map,o=function(t,e){var i=t.fields,s=t.updater;i.forEach((function(t){s(t,e[t])}))},n={create:function(t,e){var i=(0,s.g)(t),n=new Map,c={wormholes:n,state:e};r.set(t,c);var d=t.connectedCallback;t.connectedCallback=function(){r.set(t,c),d&&d.call(t)};var a=t.disconnectedCallback;t.disconnectedCallback=function(){r.delete(t),a&&a.call(t)},i.addEventListener("openWormhole",(function(t){t.stopPropagation();var e=t.detail,i=e.consumer,s=e.onOpen;if(!n.has(i)){if("symbol"!=typeof i){var r=i.connectedCallback,d=i.disconnectedCallback;i.connectedCallback=function(){n.set(i,t.detail),r&&r.call(i)},i.disconnectedCallback=function(){n.delete(i),d&&d.call(i)}}n.set(i,t.detail),o(t.detail,c.state),null==s||s.resolve((function(){n.delete(i)}))}})),i.addEventListener("closeWormhole",(function(t){var e=t.detail;n.delete(e)}))},Provider:function(t,e){var i=t.state,n=(0,s.a)();if(r.has(n)){var c=r.get(n);c.state=i,c.wormholes.forEach((function(t){o(t,i)}))}return e}}}}]);
//# sourceMappingURL=3106.js.map