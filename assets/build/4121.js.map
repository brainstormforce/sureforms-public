{"version":3,"file":"4121.js","mappings":"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","sources":["webpack://sureforms/./node_modules/@surecart/components/dist/esm/lazy-64c2bf3b.js","webpack://sureforms/./node_modules/@surecart/components/dist/esm/price-ca142cc6.js","webpack://sureforms/./node_modules/@surecart/components/dist/esm/sc-subscription-switch.entry.js"],"sourcesContent":["/** Do something the first time the element is visible */\nconst onFirstVisible = (el, callback) => {\n  const intersectionObserver = new window.IntersectionObserver((entries, observer) => {\n    if (entries[0].intersectionRatio > 0) {\n      callback();\n      observer.unobserve(entries[0].target);\n    }\n  });\n  intersectionObserver.observe(el);\n};\n\nexport { onFirstVisible as o };\n","import { _ as __, s as sprintf, a as _n } from './default-i18n-c67eee5a.js';\n\nconst convertAmount = (amount, currency) => {\n  return ['bif', 'clp', 'djf', 'gnf', 'jpy', 'kmf', 'krw'].includes(currency) ? amount : amount / 100;\n};\nconst getHumanDiscount = (coupon) => {\n  if (coupon.amount_off && coupon.currency) {\n    return getFormattedPrice({ amount: coupon.amount_off, currency: coupon.currency });\n  }\n  if (coupon.percent_off) {\n    // TODO: Translators.\n    return `${coupon.percent_off | 0}% off`;\n  }\n  return '';\n};\nconst getFormattedPrice = ({ amount, currency }) => {\n  const converted = convertAmount(amount, currency);\n  return `${new Intl.NumberFormat(undefined, {\n    style: 'currency',\n    currency: currency,\n  }).format(parseFloat(converted.toFixed(2)))}`;\n};\n// get the currency symbol for a currency code.\nconst getCurrencySymbol = (code = 'usd') => {\n  const [currency] = new Intl.NumberFormat(undefined, {\n    style: 'currency',\n    currency: code,\n  }).formatToParts();\n  return currency === null || currency === void 0 ? void 0 : currency.value;\n};\nconst translateInterval = (amount, interval, prefix = __('every', 'surecart'), fallback = __('once', 'surecart'), showSingle = false) => {\n  switch (interval) {\n    case 'day':\n      return `${prefix} ${sprintf(showSingle ? _n('%d day', '%d days', amount, 'surecart') : _n('day', '%d days', amount, 'surecart'), amount)}`;\n    case 'week':\n      return `${prefix} ${sprintf(showSingle ? _n('%d week', '%d weeks', amount, 'surecart') : _n('week', '%d weeks', amount, 'surecart'), amount)}`;\n    case 'month':\n      return `${prefix} ${sprintf(showSingle ? _n('%d month', '%d months', amount, 'surecart') : _n('month', '%d months', amount, 'surecart'), amount)}`;\n    case 'year':\n      return `${prefix} ${sprintf(showSingle ? _n('%d year', '%d years', amount, 'surecart') : _n('year', '%d years', amount, 'surecart'), amount)}`;\n    default:\n      return fallback;\n  }\n};\nconst intervalString = (price, options = {}) => {\n  if (!price) {\n    return '';\n  }\n  const { showOnce, labels } = options;\n  const { interval = __('every', 'surecart'), period = __('for', 'surecart') } = labels || {};\n  return `${intervalCountString(price, interval, !!showOnce ? __('once', 'surecart') : '')} ${periodCountString(price, period)}`;\n};\nconst intervalCountString = (price, prefix, fallback = __('once', 'surecart')) => {\n  if (!price.recurring_interval_count || !price.recurring_interval) {\n    return '';\n  }\n  return translateInterval(price.recurring_interval_count, price.recurring_interval, ` ${prefix}`, fallback);\n};\nconst periodCountString = (price, prefix, fallback = '') => {\n  if (!(price === null || price === void 0 ? void 0 : price.recurring_period_count) || !(price === null || price === void 0 ? void 0 : price.recurring_interval)) {\n    return '';\n  }\n  return translateInterval(((price === null || price === void 0 ? void 0 : price.recurring_period_count) || 0) * (price === null || price === void 0 ? void 0 : price.recurring_interval_count), price === null || price === void 0 ? void 0 : price.recurring_interval, ` ${prefix}`, fallback, true);\n};\n\nexport { getCurrencySymbol as a, getHumanDiscount as g, intervalString as i, translateInterval as t };\n","import { r as registerInstance, h, F as Fragment, g as getElement } from './index-430bb51b.js';\nimport { _ as __ } from './default-i18n-c67eee5a.js';\nimport { a as apiFetch } from './fetch-d56a3ec0.js';\nimport { o as onFirstVisible } from './lazy-64c2bf3b.js';\nimport { i as intervalString } from './price-ca142cc6.js';\nimport { a as addQueryArgs } from './add-query-args-f4c5962b.js';\nimport './_commonjsHelpers-9943807e.js';\n\nconst scSubscriptionSwitchCss = \":host{display:block;position:relative}[hidden]{display:none !important}.subscriptions-switch{display:grid;gap:0.5em}.subscriptions-switch__switcher{background:rgba(0, 0, 0, 0.035);padding:2px;line-height:1;border-radius:var(--sc-border-radius-small)}\";\n\nconst ScSubscriptionSwitch = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.filterAbove = 4;\n    /** Holds the products */\n    this.products = [];\n    /** Filter state */\n    this.filter = 'month';\n  }\n  componentWillLoad() {\n    onFirstVisible(this.el, async () => {\n      try {\n        this.loading = true;\n        await Promise.all([this.getGroup(), this.getProductPrices()]);\n      }\n      catch (e) {\n        console.error(e);\n        if (e === null || e === void 0 ? void 0 : e.message) {\n          this.error = e.message;\n        }\n        else {\n          this.error = __('Something went wrong', 'surecart');\n        }\n      }\n      finally {\n        this.loading = false;\n      }\n    });\n    this.handleSubscriptionChange();\n  }\n  handleProductsChange() {\n    var _a;\n    this.prices = this.products\n      .map(product => { var _a, _b; return (_b = (_a = product) === null || _a === void 0 ? void 0 : _a.prices) === null || _b === void 0 ? void 0 : _b.data; })\n      .flat()\n      .filter((v, i, a) => a.findIndex(t => t.id === v.id) === i); // remove duplicates.\n    this.showFilters = ((_a = this.prices) === null || _a === void 0 ? void 0 : _a.length) > this.filterAbove;\n  }\n  handlePricesChange(val, prev) {\n    if (!(prev === null || prev === void 0 ? void 0 : prev.length) && (val === null || val === void 0 ? void 0 : val.length)) {\n      this.selectedPrice = val.find(price => { var _a, _b; return price.id === ((_b = (_a = this.subscription) === null || _a === void 0 ? void 0 : _a.price) === null || _b === void 0 ? void 0 : _b.id); });\n    }\n    this.hasFilters = {\n      ...this.hasFilters,\n      split: this.prices.some(price => price.recurring_interval === 'month' && (price === null || price === void 0 ? void 0 : price.recurring_period_count)),\n      month: this.prices.some(price => price.recurring_interval === 'month' && !(price === null || price === void 0 ? void 0 : price.recurring_period_count)),\n      year: this.prices.some(price => price.recurring_interval === 'year'),\n      never: this.prices.some(price => price.recurring_interval === 'never' || !price.recurring_interval),\n    };\n  }\n  handleSubscriptionChange() {\n    var _a, _b;\n    this.filter = ((_b = (_a = this.subscription) === null || _a === void 0 ? void 0 : _a.price) === null || _b === void 0 ? void 0 : _b.recurring_interval) || 'month';\n  }\n  /** Get all subscriptions */\n  async getGroup() {\n    if (!this.productGroupId)\n      return;\n    const products = (await await apiFetch({\n      path: addQueryArgs(`surecart/v1/products/`, {\n        product_group_ids: [this.productGroupId],\n        expand: ['prices'],\n        ...this.query,\n      }),\n    }));\n    this.products = [...this.products, ...products];\n  }\n  /** Get the product's prices. */\n  async getProductPrices() {\n    if (!this.productId)\n      return;\n    const product = (await await apiFetch({\n      path: addQueryArgs(`surecart/v1/products/${this.productId}`, {\n        expand: ['prices'],\n      }),\n    }));\n    this.products = [...this.products, ...[product]];\n  }\n  async handleSubmit(e) {\n    var _a;\n    const { plan } = await e.target.getFormJson();\n    const price = this.prices.find(p => p.id === plan);\n    const currentPlan = (_a = this.subscription) === null || _a === void 0 ? void 0 : _a.price;\n    if ((price === null || price === void 0 ? void 0 : price.id) === currentPlan.id && !(price === null || price === void 0 ? void 0 : price.ad_hoc))\n      return;\n    // confirm ad_hoc amount.\n    if (price === null || price === void 0 ? void 0 : price.ad_hoc) {\n      this.busy = true;\n      return window.location.assign(addQueryArgs(window.location.href, {\n        action: 'confirm_amount',\n        price_id: plan,\n      }));\n    }\n    // confirm plan.\n    this.busy = true;\n    window.location.assign(addQueryArgs(window.location.href, {\n      action: 'confirm',\n      price_id: plan,\n    }));\n  }\n  renderSwitcher() {\n    const hasMultipleFilters = Object.values(this.hasFilters || {}).filter(v => !!v).length > 1;\n    if (!hasMultipleFilters)\n      return;\n    if (!this.showFilters)\n      return;\n    return (h(\"sc-flex\", { slot: \"end\", class: \"subscriptions-switch__switcher\" }, this.hasFilters.month && (h(\"sc-button\", { onClick: () => (this.filter = 'month'), size: \"small\", type: this.filter === 'month' ? 'default' : 'text' }, __('Monthly', 'surecart'))), this.hasFilters.week && (h(\"sc-button\", { onClick: () => (this.filter = 'week'), size: \"small\", type: this.filter === 'week' ? 'default' : 'text' }, __('Weekly', 'surecart'))), this.hasFilters.year && (h(\"sc-button\", { onClick: () => (this.filter = 'year'), size: \"small\", type: this.filter === 'year' ? 'default' : 'text' }, __('Yearly', 'surecart'))), this.hasFilters.never && (h(\"sc-button\", { onClick: () => (this.filter = 'never'), size: \"small\", type: this.filter === 'never' ? 'default' : 'text' }, __('Lifetime', 'surecart'))), this.hasFilters.split && (h(\"sc-button\", { onClick: () => (this.filter = 'split'), size: \"small\", type: this.filter === 'split' ? 'default' : 'text' }, __('Payment Plan', 'surecart')))));\n  }\n  renderLoading() {\n    return (h(\"sc-choice\", { name: \"loading\", disabled: true }, h(\"sc-skeleton\", { style: { width: '60px', display: 'inline-block' } }), h(\"sc-skeleton\", { style: { width: '80px', display: 'inline-block' }, slot: \"price\" }), h(\"sc-skeleton\", { style: { width: '120px', display: 'inline-block' }, slot: \"description\" })));\n  }\n  /** Is the price hidden or not */\n  isHidden(price) {\n    // don't hide if no filters.\n    if (!this.showFilters)\n      return false;\n    // hide if the filter does not match the recurring interval.\n    let hidden = this.filter !== price.recurring_interval;\n    // if filter is never, show prices with non-recurring interval.\n    if (this.filter === 'never' && !(price === null || price === void 0 ? void 0 : price.recurring_interval)) {\n      hidden = false;\n    }\n    // if filter is split, show prices with a recurring_period_count.\n    if (this.filter === 'split' && (price === null || price === void 0 ? void 0 : price.recurring_period_count)) {\n      hidden = false;\n    }\n    return hidden;\n  }\n  renderContent() {\n    if (this.loading) {\n      return this.renderLoading();\n    }\n    return (h(\"sc-choices\", { required: true }, h(\"div\", null, (this.prices || []).map(price => {\n      var _a, _b;\n      const currentPlan = ((_b = (_a = this.subscription) === null || _a === void 0 ? void 0 : _a.price) === null || _b === void 0 ? void 0 : _b.id) === (price === null || price === void 0 ? void 0 : price.id);\n      const product = this.products.find(product => product.id === (price === null || price === void 0 ? void 0 : price.product));\n      return (h(\"sc-choice\", { key: price === null || price === void 0 ? void 0 : price.id, checked: currentPlan, name: \"plan\", value: price === null || price === void 0 ? void 0 : price.id, hidden: this.isHidden(price), onScChange: e => {\n          if (e.detail) {\n            this.selectedPrice = this.prices.find(p => p.id === (price === null || price === void 0 ? void 0 : price.id));\n          }\n        } }, h(\"div\", null, h(\"strong\", null, product === null || product === void 0 ? void 0 : product.name)), h(\"div\", { slot: \"description\" }, (price === null || price === void 0 ? void 0 : price.ad_hoc) ? (`${__('Custom amount', 'surecart')} ${intervalString(price)}`) : (h(Fragment, null, h(\"sc-format-number\", { type: \"currency\", currency: (price === null || price === void 0 ? void 0 : price.currency) || 'usd', value: price === null || price === void 0 ? void 0 : price.amount }), \" \", intervalString(price, { showOnce: true })))), currentPlan && (h(\"sc-tag\", { type: \"warning\", slot: \"price\" }, __('Current Plan', 'surecart')))));\n    }))));\n  }\n  buttonText() {\n    var _a, _b, _c, _d;\n    if ((_a = this.selectedPrice) === null || _a === void 0 ? void 0 : _a.ad_hoc) {\n      if (((_b = this.selectedPrice) === null || _b === void 0 ? void 0 : _b.id) === ((_d = (_c = this.subscription) === null || _c === void 0 ? void 0 : _c.price) === null || _d === void 0 ? void 0 : _d.id)) {\n        return __('Update Amount', 'surecart');\n      }\n      else {\n        return __('Choose Amount', 'surecart');\n      }\n    }\n    return __('Next', 'surecart');\n  }\n  render() {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    // we are not loading and we don't have enough prices to switch.\n    if (!this.loading && ((_a = this.prices) === null || _a === void 0 ? void 0 : _a.length) < 2) {\n      if (!((_c = (_b = this.prices) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.ad_hoc)) {\n        return null;\n      }\n    }\n    // subscription is a payment plan.\n    if ((_d = this.subscription) === null || _d === void 0 ? void 0 : _d.remaining_period_count) {\n      return (h(\"sc-alert\", { type: \"info\", open: true }, __('To make changes to your payment plan, please contact us.', 'surecart')));\n    }\n    return (h(\"sc-dashboard-module\", { heading: this.heading || __('Update Plan', 'surecart'), class: \"subscription-switch\", error: this.error }, h(\"span\", { slot: \"end\" }, this.renderSwitcher()), h(\"sc-form\", { class: \"subscriptions-switch\", onScFormSubmit: e => this.handleSubmit(e) }, this.renderContent(), h(\"sc-button\", { type: \"primary\", full: true, submit: true, loading: this.loading || this.busy, disabled: ((_f = (_e = this.subscription) === null || _e === void 0 ? void 0 : _e.price) === null || _f === void 0 ? void 0 : _f.id) === ((_g = this.selectedPrice) === null || _g === void 0 ? void 0 : _g.id) && !((_h = this.selectedPrice) === null || _h === void 0 ? void 0 : _h.ad_hoc) }, this.buttonText(), \" \", h(\"sc-icon\", { name: \"arrow-right\", slot: \"suffix\" })), this.busy && h(\"sc-block-ui\", { style: { zIndex: '9' } }))));\n  }\n  get el() { return getElement(this); }\n  static get watchers() { return {\n    \"products\": [\"handleProductsChange\"],\n    \"prices\": [\"handlePricesChange\"],\n    \"subscription\": [\"handleSubscriptionChange\"]\n  }; }\n};\nScSubscriptionSwitch.style = scSubscriptionSwitchCss;\n\nexport { ScSubscriptionSwitch as sc_subscription_switch };\n"],"names":["onFirstVisible","el","callback","window","IntersectionObserver","entries","observer","intersectionRatio","unobserve","target","observe","getHumanDiscount","coupon","amount_off","currency","getFormattedPrice","amount","percent_off","converted","includes","convertAmount","Intl","NumberFormat","undefined","style","format","parseFloat","toFixed","getCurrencySymbol","code","formatToParts","value","translateInterval","interval","prefix","_","fallback","showSingle","s","intervalString","price","options","showOnce","labels","period","intervalCountString","periodCountString","recurring_interval_count","recurring_interval","recurring_period_count","ScSubscriptionSwitch","constructor","hostRef","r","this","filterAbove","products","filter","componentWillLoad","o","async","loading","Promise","all","getGroup","getProductPrices","e","console","error","message","handleSubscriptionChange","handleProductsChange","_a","prices","map","product","_b","data","flat","v","i","a","findIndex","t","id","showFilters","length","handlePricesChange","val","prev","selectedPrice","find","subscription","hasFilters","split","some","month","year","never","productGroupId","path","product_group_ids","expand","query","productId","plan","getFormJson","p","currentPlan","ad_hoc","busy","location","assign","href","action","price_id","renderSwitcher","Object","values","h","slot","class","onClick","size","type","week","renderLoading","name","disabled","width","display","isHidden","hidden","renderContent","required","key","checked","onScChange","detail","F","buttonText","_c","_d","render","_e","_f","_g","_h","remaining_period_count","open","heading","onScFormSubmit","handleSubmit","full","submit","zIndex","g","watchers"],"sourceRoot":""}