{"version":3,"file":"6405.js","mappings":"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","sources":["webpack://sureforms/./node_modules/@surecart/components-react/node_modules/@surecart/components/dist/esm/sc-order-confirmation.entry.js","webpack://sureforms/./node_modules/@surecart/components-react/node_modules/@surecart/components/dist/esm/universe-d405bbd3.js"],"sourcesContent":["import { r as registerInstance, h } from './index-430bb51b.js';\nimport { g as getQueryArg, a as apiFetch } from './fetch-d56a3ec0.js';\nimport { _ as __ } from './default-i18n-c67eee5a.js';\nimport { U as Universe } from './universe-d405bbd3.js';\nimport { a as addQueryArgs } from './add-query-args-f4c5962b.js';\nimport './_commonjsHelpers-9943807e.js';\n\nconst scOrderConfirmationCss = \":host{display:block;max-width:800px;margin:auto}.order-confirmation__content{display:grid;gap:var(--sc-form-row-spacing-large)}.order-confirmation__content.hidden{display:none}::part(line-items){display:grid;gap:0.5em}\";\n\nconst ScOrderConfirmation = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    /** Loading */\n    this.loading = false;\n  }\n  componentWillLoad() {\n    // @ts-ignore\n    Universe.create(this, this.state());\n    // get teh session\n    this.getSession();\n  }\n  /** Get session id from url. */\n  getSessionId() {\n    var _a;\n    if ((_a = this.order) === null || _a === void 0 ? void 0 : _a.id)\n      return this.order.id;\n    return getQueryArg(window.location.href, 'order');\n  }\n  /** Update a session */\n  async getSession() {\n    var _a;\n    if (!this.getSessionId())\n      return;\n    if ((_a = this.order) === null || _a === void 0 ? void 0 : _a.id)\n      return;\n    try {\n      this.loading = true;\n      this.order = (await await apiFetch({\n        path: addQueryArgs(`surecart/v1/orders/${this.getSessionId()}`, {\n          expand: [\n            'line_items',\n            'line_item.price',\n            'price.product',\n            'customer',\n            'customer.shipping_address',\n            'payment_intent',\n            'discount',\n            'discount.promotion',\n            'billing_address',\n            'shipping_address',\n          ],\n          refresh_status: true,\n        }),\n      }));\n    }\n    catch (e) {\n      if (e === null || e === void 0 ? void 0 : e.message) {\n        this.error = e.message;\n      }\n      else {\n        this.error = __('Something went wrong', 'surecart');\n      }\n    }\n    finally {\n      this.loading = false;\n    }\n  }\n  state() {\n    var _a;\n    return {\n      processor: 'stripe',\n      loading: this.loading,\n      orderId: this.getSessionId(),\n      order: this.order,\n      customer: (_a = this.order) === null || _a === void 0 ? void 0 : _a.customer,\n    };\n  }\n  render() {\n    var _a, _b;\n    return (h(Universe.Provider, { state: this.state() }, h(\"div\", { class: { 'order-confirmation': true } }, h(\"div\", { class: {\n        'order-confirmation__content': true,\n        'hidden': !((_a = this.order) === null || _a === void 0 ? void 0 : _a.id) && !this.loading,\n      } }, h(\"slot\", null)), !((_b = this.order) === null || _b === void 0 ? void 0 : _b.id) && !this.loading && (h(\"sc-heading\", null, __('Order not found.', 'surecart'), h(\"span\", { slot: \"description\" }, __('This order could not be found. Please try again.', 'surecart')))))));\n  }\n};\nScOrderConfirmation.style = scOrderConfirmationCss;\n\nexport { ScOrderConfirmation as sc_order_confirmation };\n","import { g as getElement, a as getRenderingRef } from './index-430bb51b.js';\n\nvar multiverse = new Map();\nvar updateConsumer = function (_a, state) {\n    var fields = _a.fields, updater = _a.updater;\n    fields.forEach(function (field) { updater(field, state[field]); });\n};\nvar Universe = {\n    create: function (creator, initialState) {\n        var el = getElement(creator);\n        var wormholes = new Map();\n        var universe = { wormholes: wormholes, state: initialState };\n        multiverse.set(creator, universe);\n        var connectedCallback = creator.connectedCallback;\n        creator.connectedCallback = function () {\n            multiverse.set(creator, universe);\n            if (connectedCallback) {\n                connectedCallback.call(creator);\n            }\n        };\n        var disconnectedCallback = creator.disconnectedCallback;\n        creator.disconnectedCallback = function () {\n            multiverse.delete(creator);\n            if (disconnectedCallback) {\n                disconnectedCallback.call(creator);\n            }\n        };\n        el.addEventListener('openWormhole', function (event) {\n            event.stopPropagation();\n            var _a = event.detail, consumer = _a.consumer, onOpen = _a.onOpen;\n            if (wormholes.has(consumer))\n                return;\n            if (typeof consumer !== 'symbol') {\n                var connectedCallback_1 = consumer.connectedCallback, disconnectedCallback_1 = consumer.disconnectedCallback;\n                consumer.connectedCallback = function () {\n                    wormholes.set(consumer, event.detail);\n                    if (connectedCallback_1) {\n                        connectedCallback_1.call(consumer);\n                    }\n                };\n                consumer.disconnectedCallback = function () {\n                    wormholes.delete(consumer);\n                    if (disconnectedCallback_1) {\n                        disconnectedCallback_1.call(consumer);\n                    }\n                };\n            }\n            wormholes.set(consumer, event.detail);\n            updateConsumer(event.detail, universe.state);\n            onOpen === null || onOpen === void 0 ? void 0 : onOpen.resolve(function () { wormholes.delete(consumer); });\n        });\n        el.addEventListener('closeWormhole', function (event) {\n            var consumer = event.detail;\n            wormholes.delete(consumer);\n        });\n    },\n    Provider: function (_a, children) {\n        var state = _a.state;\n        var creator = getRenderingRef();\n        if (multiverse.has(creator)) {\n            var universe = multiverse.get(creator);\n            universe.state = state;\n            universe.wormholes.forEach(function (opening) { updateConsumer(opening, state); });\n        }\n        return children;\n    }\n};\n\nexport { Universe as U };\n"],"names":["ScOrderConfirmation","constructor","hostRef","r","this","loading","componentWillLoad","U","state","getSession","getSessionId","_a","order","id","g","window","location","href","async","a","path","expand","refresh_status","e","message","error","_","processor","orderId","customer","render","_b","h","class","slot","style","multiverse","Map","updateConsumer","fields","updater","forEach","field","Universe","create","creator","initialState","el","wormholes","universe","set","connectedCallback","call","disconnectedCallback","delete","addEventListener","event","stopPropagation","detail","consumer","onOpen","has","connectedCallback_1","disconnectedCallback_1","resolve","Provider","children","get","opening"],"sourceRoot":""}