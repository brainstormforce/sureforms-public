{"version":3,"file":"8695.js","mappings":"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","sources":["webpack://sureforms/./node_modules/@surecart/components/dist/esm/lazy-64c2bf3b.js","webpack://sureforms/./node_modules/@surecart/components/dist/esm/sc-subscriptions-list.entry.js"],"sourcesContent":["/** Do something the first time the element is visible */\nconst onFirstVisible = (el, callback) => {\n  const intersectionObserver = new window.IntersectionObserver((entries, observer) => {\n    if (entries[0].intersectionRatio > 0) {\n      callback();\n      observer.unobserve(entries[0].target);\n    }\n  });\n  intersectionObserver.observe(el);\n};\n\nexport { onFirstVisible as o };\n","import { r as registerInstance, h, g as getElement } from './index-430bb51b.js';\nimport { _ as __ } from './default-i18n-c67eee5a.js';\nimport { a as apiFetch } from './fetch-d56a3ec0.js';\nimport { o as onFirstVisible } from './lazy-64c2bf3b.js';\nimport { a as addQueryArgs } from './add-query-args-f4c5962b.js';\nimport './_commonjsHelpers-9943807e.js';\n\nconst scSubscriptionsListCss = \":host{display:block}.subscriptions-list{display:grid;gap:0.5em}.subscriptions-list__heading{display:flex;flex-wrap:wrap;align-items:flex-end;justify-content:space-between;margin-bottom:0.5em}.subscriptions-list__title{font-size:var(--sc-font-size-x-large);font-weight:var(--sc-font-weight-bold);line-height:var(--sc-line-height-dense)}.subscriptions-list a{text-decoration:none;font-weight:var(--sc-font-weight-semibold);display:inline-flex;align-items:center;gap:0.25em;color:var(--sc-color-primary-500)}.subscriptions__title{display:none}.subscriptions--has-title-slot .subscriptions__title{display:block}\";\n\nconst ScSubscriptionsList = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    /** Customer id to fetch subscriptions */\n    this.query = {\n      page: 1,\n      per_page: 10,\n    };\n    this.cancelBehavior = 'period_end';\n    this.subscriptions = [];\n    this.pagination = {\n      total: 0,\n      total_pages: 0,\n    };\n  }\n  componentWillLoad() {\n    onFirstVisible(this.el, () => {\n      this.initialFetch();\n    });\n  }\n  async initialFetch() {\n    try {\n      this.loading = true;\n      await this.getSubscriptions();\n    }\n    catch (e) {\n      console.error(this.error);\n      this.error = (e === null || e === void 0 ? void 0 : e.message) || __('Something went wrong', 'surecart');\n    }\n    finally {\n      this.loading = false;\n    }\n  }\n  async fetchSubscriptions() {\n    try {\n      this.busy = true;\n      await this.getSubscriptions();\n    }\n    catch (e) {\n      console.error(this.error);\n      this.error = (e === null || e === void 0 ? void 0 : e.message) || __('Something went wrong', 'surecart');\n    }\n    finally {\n      this.busy = false;\n    }\n  }\n  /** Get all subscriptions */\n  async getSubscriptions() {\n    const response = (await await apiFetch({\n      path: addQueryArgs(`surecart/v1/subscriptions/`, {\n        expand: ['price', 'price.product', 'latest_invoice'],\n        ...this.query,\n      }),\n      parse: false,\n    }));\n    this.pagination = {\n      total: parseInt(response.headers.get('X-WP-Total')),\n      total_pages: parseInt(response.headers.get('X-WP-TotalPages')),\n    };\n    this.subscriptions = (await response.json());\n    return this.subscriptions;\n  }\n  nextPage() {\n    this.query.page = this.query.page + 1;\n    this.fetchSubscriptions();\n  }\n  prevPage() {\n    this.query.page = this.query.page - 1;\n    this.fetchSubscriptions();\n  }\n  renderEmpty() {\n    return (h(\"div\", null, h(\"sc-divider\", { style: { '--spacing': '0' } }), h(\"slot\", { name: \"empty\" }, h(\"sc-empty\", { icon: \"repeat\" }, __(\"You don't have any subscriptions.\", 'surecart')))));\n  }\n  renderLoading() {\n    return (h(\"sc-card\", { \"no-padding\": true, style: { '--overflow': 'hidden' } }, h(\"sc-stacked-list\", null, h(\"sc-stacked-list-row\", { style: { '--columns': '2' }, \"mobile-size\": 0 }, h(\"div\", { style: { padding: '0.5em' } }, h(\"sc-skeleton\", { style: { width: '30%', marginBottom: '0.75em' } }), h(\"sc-skeleton\", { style: { width: '20%', marginBottom: '0.75em' } }), h(\"sc-skeleton\", { style: { width: '40%' } }))))));\n  }\n  renderList() {\n    return this.subscriptions.map(subscription => {\n      return (h(\"sc-stacked-list-row\", { href: (subscription === null || subscription === void 0 ? void 0 : subscription.status) !== 'canceled'\n          ? addQueryArgs(window.location.href, {\n            action: 'edit',\n            model: 'subscription',\n            id: subscription.id,\n          })\n          : null, key: subscription.id, \"mobile-size\": 0 }, h(\"sc-subscription-details\", { subscription: subscription }), h(\"sc-icon\", { name: \"chevron-right\", slot: \"suffix\" })));\n    });\n  }\n  renderContent() {\n    var _a;\n    if (this.loading) {\n      return this.renderLoading();\n    }\n    if (((_a = this.subscriptions) === null || _a === void 0 ? void 0 : _a.length) === 0) {\n      return this.renderEmpty();\n    }\n    return (h(\"sc-card\", { \"no-padding\": true, style: { '--overflow': 'hidden' } }, h(\"sc-stacked-list\", null, this.renderList())));\n  }\n  render() {\n    var _a, _b;\n    return (h(\"sc-dashboard-module\", { class: \"subscriptions-list\", error: this.error }, h(\"span\", { slot: \"heading\" }, h(\"slot\", { name: \"heading\" }, this.heading || __('Subscriptions', 'surecart'))), !!this.allLink && !!((_a = this.subscriptions) === null || _a === void 0 ? void 0 : _a.length) && (h(\"sc-button\", { type: \"link\", href: this.allLink, slot: \"end\" }, __('View all', 'surecart'), h(\"sc-icon\", { name: \"chevron-right\", slot: \"suffix\" }))), this.renderContent(), !this.allLink && (h(\"sc-pagination\", { page: this.query.page, perPage: this.query.per_page, total: this.pagination.total, totalPages: this.pagination.total_pages, totalShowing: (_b = this === null || this === void 0 ? void 0 : this.subscriptions) === null || _b === void 0 ? void 0 : _b.length, onScNextPage: () => this.nextPage(), onScPrevPage: () => this.prevPage() })), this.busy && h(\"sc-block-ui\", null)));\n  }\n  get el() { return getElement(this); }\n};\nScSubscriptionsList.style = scSubscriptionsListCss;\n\nexport { ScSubscriptionsList as sc_subscriptions_list };\n"],"names":["onFirstVisible","el","callback","window","IntersectionObserver","entries","observer","intersectionRatio","unobserve","target","observe","ScSubscriptionsList","constructor","hostRef","r","this","query","page","per_page","cancelBehavior","subscriptions","pagination","total","total_pages","componentWillLoad","o","initialFetch","async","loading","getSubscriptions","e","console","error","message","_","busy","response","a","path","expand","parse","parseInt","headers","get","json","nextPage","fetchSubscriptions","prevPage","renderEmpty","h","style","name","icon","renderLoading","padding","width","marginBottom","renderList","map","subscription","href","status","location","action","model","id","key","slot","renderContent","_a","length","render","_b","class","heading","allLink","type","perPage","totalPages","totalShowing","onScNextPage","onScPrevPage","g"],"sourceRoot":""}