{"version":3,"file":"1419.js","mappings":"uMAMA,MAEMA,EAAU,MACdC,YAAYC,IACV,IAAAC,GAAiBC,KAAMF,GACvBE,KAAKC,KAAO,GACZD,KAAKE,MAAQ,GACbF,KAAKG,SAAW,EAClB,CAEAC,mBACoB,aAAdJ,KAAKC,MACPI,YAAW,KACTL,KAAKM,cAAcC,cAAc,GAChC,GAEP,CACAC,oBACER,KAAKE,MAAQF,KAAKS,WAAWC,KAC/B,CAEAC,wBACE,IACEX,KAAKY,SAAU,QACT,IAAAC,GAAS,CACbC,OAAQ,OACRC,KAAM,6BACNC,KAAM,CACJd,MAAOF,KAAKE,MACZe,WAAYC,OAAOC,SAASC,QAGhCpB,KAAKC,KAAO,UACd,CACA,MAAOoB,IACDA,aAA6B,EAASA,EAAEC,SAC1CtB,KAAKuB,MAAQF,EAAEC,QAGftB,KAAKuB,OAAQ,IAAAC,GAAG,uBAAwB,YAE1CC,QAAQF,MAAMvB,KAAKuB,MACrB,CACA,QACEvB,KAAKY,SAAU,CACjB,CACF,CACAD,cACE,IACEX,KAAKY,SAAU,EACf,MAAM,aAAEc,SAAuB,IAAAb,GAAS,CACtCC,OAAQ,OACRC,KAAM,oBACNC,KAAM,CACJW,MAAO3B,KAAKE,MACZC,SAAUH,KAAKG,YAGfuB,EACFR,OAAOC,SAASS,QAAQF,GAGxBR,OAAOC,SAASU,QAEpB,CACA,MAAOR,GACLI,QAAQF,MAAMvB,KAAKuB,OACnBvB,KAAKY,SAAU,GACXS,aAA6B,EAASA,EAAEC,SAC1CtB,KAAKuB,MAAQF,EAAEC,QAGftB,KAAKuB,OAAQ,IAAAC,GAAG,uBAAwB,WAE5C,CACF,CACAM,cACE,MAAkB,aAAd9B,KAAKC,MACC,IAAA8B,GAAE,WAAY,CAAEC,KAAM,UAAWC,MAAM,IAAQ,IAAAF,GAAE,UAAW,CAAEG,KAAM,OAAQC,KAAM,WAAY,IAAAJ,GAAE,OAAQ,CAAEG,KAAM,UAAW,IAAAV,GAAG,QAAS,cAAc,IAAAO,GAAE,IAAK,MAAM,IAAAP,GAAG,4DAA6D,cAE1N,aAAdxB,KAAKC,MAAuBD,KAAKE,OAC3B,IAAA6B,GAAE,MAAO,MAAM,IAAAA,GAAE,UAAW,CAAEK,eAAgB,IAAMpC,KAAKqC,oBAAqB,IAAAN,GAAE,YAAa,CAAEC,KAAM,UAAWM,QAAQ,EAAMC,MAAM,IAAQ,IAAAR,GAAE,UAAW,CAAEI,KAAM,OAAQD,KAAM,YAAa,IAAAV,GAAG,oBAAqB,eAAe,IAAAO,GAAE,aAAc,MAAM,IAAAP,GAAG,KAAM,cAAc,IAAAO,GAAE,UAAW,CAAEK,eAAgB,IAAMpC,KAAK2B,UAAW,IAAAI,GAAE,WAAY,CAAES,OAAO,IAAAhB,GAAG,sBAAuB,YAAaQ,KAAM,WAAYS,IAAKC,GAAO1C,KAAKM,cAAgBoC,EAAKC,WAAW,EAAMC,UAAU,EAAMC,WAAYxB,GAAMrB,KAAKG,SAAWkB,EAAEyB,OAAOpC,SAAW,IAAAqB,GAAE,YAAa,CAAEC,KAAM,UAAWe,SAAS,EAAMT,QAAQ,EAAMC,MAAM,IAAQ,IAAAR,GAAE,UAAW,CAAEI,KAAM,OAAQD,KAAM,YAAa,IAAAV,GAAG,QAAS,gBAE7pB,IAAAO,GAAE,UAAW,CAAEK,eAAgB,IAAOpC,KAAKC,KAAO,aAAe,IAAA8B,GAAE,WAAY,CAAEU,IAAKC,GAAO1C,KAAKS,WAAaiC,EAAKF,MAAO,gBAAiBK,WAAY,IAAM7C,KAAKQ,oBAAqBoC,UAAU,EAAMD,WAAW,EAAMX,KAAM,WAAY,IAAAD,GAAE,YAAa,CAAEC,KAAM,UAAWM,QAAQ,EAAMC,MAAM,IAAQ,IAAAR,GAAE,UAAW,CAAEI,KAAM,cAAeD,KAAM,YAAa,IAAAV,GAAG,OAAQ,aACrX,CACAwB,cACE,GAAIhD,KAAKuB,MACP,OAAQ,IAAAQ,GAAE,WAAY,CAAEE,MAAM,EAAMD,KAAM,WAAY,IAAAD,GAAE,OAAQ,CAAEG,KAAM,UAAW,IAAAV,GAAG,QAAS,cAAc,IAAAO,GAAE,OAAQ,CAAEkB,UAAWjD,KAAKuB,QAE7I,CACA2B,SACE,OAAQ,IAAAnB,GAAE,MAAO,CAAEoB,MAAO,eAAgB,IAAApB,GAAE,MAAO,CAAEoB,MAAO,oBAAqBC,KAAM,UAAW,IAAArB,GAAE,OAAQ,CAAEI,KAAM,YAAa,IAAAJ,GAAE,UAAW,KAAM/B,KAAK8B,eAAgB9B,KAAKY,UAAW,IAAAmB,GAAE,cAAe,CAAEsB,SAAS,IAASrD,KAAKgD,cACrO,CACWM,sBAAa,MAAO,CAC7B,KAAQ,CAAC,oBACR,GAEL1D,EAAQ2D,MAjGe,iP","sources":["webpack://sureforms/./node_modules/@surecart/components-react/node_modules/@surecart/components/dist/esm/sc-login-form.entry.js"],"sourcesContent":["import { r as registerInstance, h } from './index-430bb51b.js';\nimport { _ as __ } from './default-i18n-c67eee5a.js';\nimport { a as apiFetch } from './fetch-d56a3ec0.js';\nimport './_commonjsHelpers-9943807e.js';\nimport './add-query-args-f4c5962b.js';\n\nconst scLoginFormCss = \".login-form{margin:var(--sc-spacing-xx-large) auto;max-width:400px;position:relative}.login-form__title{text-align:center;margin-bottom:var(--sc-spacing-medium);font-size:var(--sc-font-size-xx-large);font-weight:var(--sc-font-weight-bold)}\";\n\nconst ScLogin = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.step = '';\n    this.email = '';\n    this.password = '';\n  }\n  /** Focus the password field automatically on password step. */\n  handleStepChange() {\n    if (this.step === 'password') {\n      setTimeout(() => {\n        this.passwordInput.triggerFocus();\n      }, 50);\n    }\n  }\n  handleEmailChange() {\n    this.email = this.emailInput.value;\n  }\n  /** Get all subscriptions */\n  async submitMagicLink() {\n    try {\n      this.loading = true;\n      await apiFetch({\n        method: 'POST',\n        path: 'surecart/v1/customer_links',\n        data: {\n          email: this.email,\n          return_url: window.location.href,\n        },\n      });\n      this.step = 'complete';\n    }\n    catch (e) {\n      if (e === null || e === void 0 ? void 0 : e.message) {\n        this.error = e.message;\n      }\n      else {\n        this.error = __('Something went wrong', 'surecart');\n      }\n      console.error(this.error);\n    }\n    finally {\n      this.loading = false;\n    }\n  }\n  async login() {\n    try {\n      this.loading = true;\n      const { redirect_url } = await apiFetch({\n        method: 'POST',\n        path: 'surecart/v1/login',\n        data: {\n          login: this.email,\n          password: this.password,\n        },\n      });\n      if (redirect_url) {\n        window.location.replace(redirect_url);\n      }\n      else {\n        window.location.reload();\n      }\n    }\n    catch (e) {\n      console.error(this.error);\n      this.loading = false;\n      if (e === null || e === void 0 ? void 0 : e.message) {\n        this.error = e.message;\n      }\n      else {\n        this.error = __('Something went wrong', 'surecart');\n      }\n    }\n  }\n  renderInner() {\n    if (this.step === 'complete') {\n      return (h(\"sc-alert\", { type: \"success\", open: true }, h(\"sc-icon\", { slot: \"icon\", name: \"check\" }), h(\"span\", { slot: \"title\" }, __('Sent!', 'surecart')), h(\"p\", null, __('You should receive an email shortly with a link to login.', 'surecart'))));\n    }\n    if (this.step === 'password' && this.email) {\n      return (h(\"div\", null, h(\"sc-form\", { onScFormSubmit: () => this.submitMagicLink() }, h(\"sc-button\", { type: \"primary\", submit: true, full: true }, h(\"sc-icon\", { name: \"mail\", slot: \"prefix\" }), __('Send a magic link', 'surecart'))), h(\"sc-divider\", null, __('or', 'surecart')), h(\"sc-form\", { onScFormSubmit: () => this.login() }, h(\"sc-input\", { label: __('Enter your password', 'surecart'), type: \"password\", ref: el => (this.passwordInput = el), autofocus: true, required: true, onScChange: e => (this.password = e.target.value) }), h(\"sc-button\", { type: \"primary\", outline: true, submit: true, full: true }, h(\"sc-icon\", { name: \"lock\", slot: \"prefix\" }), __('Login', 'surecart')))));\n    }\n    return (h(\"sc-form\", { onScFormSubmit: () => (this.step = 'password') }, h(\"sc-input\", { ref: el => (this.emailInput = el), label: \"Email Address\", onScChange: () => this.handleEmailChange(), required: true, autofocus: true, type: \"email\" }), h(\"sc-button\", { type: \"primary\", submit: true, full: true }, h(\"sc-icon\", { name: \"arrow-right\", slot: \"suffix\" }), __('Next', 'surecart'))));\n  }\n  renderError() {\n    if (this.error) {\n      return (h(\"sc-alert\", { open: true, type: \"danger\" }, h(\"span\", { slot: \"title\" }, __('Error', 'surecart')), h(\"span\", { innerHTML: this.error })));\n    }\n  }\n  render() {\n    return (h(\"div\", { class: \"login-form\" }, h(\"div\", { class: \"login-form__title\", part: \"title\" }, h(\"slot\", { name: \"title\" })), h(\"sc-card\", null, this.renderInner()), this.loading && h(\"sc-block-ui\", { spinner: true }), this.renderError()));\n  }\n  static get watchers() { return {\n    \"step\": [\"handleStepChange\"]\n  }; }\n};\nScLogin.style = scLoginFormCss;\n\nexport { ScLogin as sc_login_form };\n"],"names":["ScLogin","constructor","hostRef","r","this","step","email","password","handleStepChange","setTimeout","passwordInput","triggerFocus","handleEmailChange","emailInput","value","async","loading","a","method","path","data","return_url","window","location","href","e","message","error","_","console","redirect_url","login","replace","reload","renderInner","h","type","open","slot","name","onScFormSubmit","submitMagicLink","submit","full","label","ref","el","autofocus","required","onScChange","target","outline","renderError","innerHTML","render","class","part","spinner","watchers","style"],"sourceRoot":""}