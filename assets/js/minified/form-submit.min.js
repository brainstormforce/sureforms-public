async function getUniqueValidationData(r,e,t,s){let o="action=validation_ajax_action&nonce="+encodeURIComponent(s)+"&id="+encodeURIComponent(e);Object.keys(r).forEach(e=>{o+="&"+encodeURIComponent(e)+"="+encodeURIComponent(r[e])});try{var a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o});if(a.ok)return(await a.json()).data}catch(e){console.error(e)}}async function fieldValidation(e,r,t,s){let o=!1,a=null,c=null;var i=document.querySelectorAll('input[aria-unique="true"]');if(0!==i.length){var n={};for(const S of i){var l=S.name,m=S.value;n[l]=m}c=await getUniqueValidationData(n,e,r,t)}for(const w of Array.from(s.querySelectorAll(".srfm-block-single"))){var u=w.closest("form").getAttribute("form-id");if(u===e){var u=w.querySelector("input, textarea,select"),f=u.getAttribute("aria-required"),d=u.getAttribute("aria-unique");let r=u.getAttribute("name");var b,g,y,p,v,L=u.value,h=w.querySelector(".srfm-error-message");if(r=r&&r.replace(/_/g," "),f&&"hidden"!==u.type&&("true"!==f||L?u&&u.closest(".srfm-block").classList.remove("srfm-error"):(u&&u.closest(".srfm-block").classList.add("srfm-error"),h&&(h.textContent=h.getAttribute("data-error-msg")),o=!0,a=a||u)),"true"===d&&""!==L&&(c?.some(e=>"not unique"===e[r])?(u&&u.closest(".srfm-block").classList.add("srfm-error"),h.textContent=h.getAttribute("data-unique-msg"),o=!0,a=a||u):u&&u.closest(".srfm-block").classList.remove("srfm-error")),w.classList.contains("srfm-multi-choice-block")||w.classList.contains("srfm-checkbox-block")){var A=w.querySelectorAll("input"),d=A[0].getAttribute("aria-required");let r=!1,t=null;for(let e=0;e<A.length;e++)if(t||"hidden"===A[e].type||(t=A[e]),A[e].checked){r=!0;break}"true"!==d||r?h&&w.classList.remove("srfm-error"):(h&&w.classList.add("srfm-error"),o=!0,!a&&t&&(a=t))}if(w.classList.contains("srfm-url-block")&&(d=w.querySelector("input"),w.classList.contains("srfm-url-error"))&&(w.classList.add("srfm-error"),o=!0,a=a||d),w.classList.contains("srfm-phone-block")&&(d=w.querySelectorAll("input")[1],w.classList.contains("srfm-phone-error"))&&(w.classList.add("srfm-error"),o=!0,a=a||d),w.classList.contains("srfm-password-block-wrap")&&(d=w)&&((v=d.querySelector(".srfm-password-confirm-block"))&&(g=d.querySelector(".srfm-input-password").value,p=v.querySelector(".srfm-input-password-confirm"))&&(b=p.value,y=v.querySelector(".srfm-error-message"),!b&&y&&"true"===f?(y.textContent=y.getAttribute("data-error-msg"),v.classList.add("srfm-error"),a=a||b,o=!0):b!==g?(v.classList.add("srfm-error"),y.textContent="Confirmation Password is not the same",v.classList.remove("srfm-strength-1"),v.classList.remove("srfm-strength-2"),v.classList.remove("srfm-strength-3"),v.classList.remove("srfm-strength-4"),a=a||p,o=!0):v.classList.remove("srfm-error")),d.querySelector(".srfm-block").classList.contains("srfm-password-error"))&&(a=a||d.querySelector("input"),o=!0),w.classList.contains("srfm-email-block-wrap")&&(b=w)&&(g=b.querySelector(".srfm-email-confirm-block"))&&(y=g.querySelector(".srfm-input-email-confirm"),p=g.querySelector(".srfm-input-email-confirm").value,v=g.querySelector(".srfm-error-message"),!p&&v&&"true"===f?(v.textContent=v.getAttribute("data-error-msg"),g.classList.add("srfm-error"),a=a||y,o=!0):p!==L?(g.classList.add("srfm-error"),v.textContent="Confirmation email is not the same",a=a||y,o=!0):g.classList.remove("srfm-error")),w.classList.contains("srfm-address-block")){var k=w.querySelectorAll("input,select"),q=k[1].getAttribute("aria-required");for(let e=1;e<k.length&&"true"===q;e++)k[e].value||2===e?w.classList.remove("srfm-error"):(w.classList.add("srfm-error"),o=!0,a=a||k[e])}w.classList.contains("srfm-upload-block")&&("true"!==(f=(d=w.querySelector(".srfm-input-upload")).getAttribute("aria-required"))||d.value?u&&u.closest(".srfm-block").classList.remove("srfm-error"):("true"===f&&h&&(h.textContent=h.getAttribute("data-error-msg")),u&&u.closest(".srfm-block").classList.add("srfm-error"),o=!0,a=a||d)),w.classList.contains("srfm-number-block")&&(f=u.getAttribute("min"),d=u.getAttribute("max"),L)&&(f&&(""!==f&&Number(L)<Number(f)?(u.closest(".srfm-block").classList.add("srfm-error"),h&&(h.textContent="Minimum value is "+f)):u.closest(".srfm-block").classList.remove("srfm-error")),d)&&(""!==d&&Number(L)>Number(d)?(u.closest(".srfm-block").classList.add("srfm-error"),h&&(h.textContent="Maximum value is "+d)):u.closest(".srfm-block").classList.remove("srfm-error")),w.classList.contains("srfm-rating-block")&&("true"!==(f=w.querySelector(".srfm-input-rating")).getAttribute("aria-required")||f.value?f.closest(".srfm-block").classList.remove("srfm-error"):(f.closest(".srfm-block").classList.add("srfm-error"),o=!0))}}return a&&a.focus(),o}function submitFormData(e){var r=sureforms_submit.site_url,e=new FormData(e);return fetch(r+"/wp-json/sureforms/v1/submit-form",{method:"POST",body:e}).then(e=>{if(e.ok)return e}).catch(e=>{console.log(e)})}function showSuccessMessage(e,r){r.style.opacity=1,r.style.display="none",e.classList.add("srfm-active"),setTimeout(()=>{e.style.opacity=1},500)}function redirectToUrl(e){window.location.assign(e)}function showErrorMessage(e){e.removeAttribute("hidden"),console.error("Network Error")}async function handleFormSubmission(e,r,t,s,o,a,c,i,n){try{var l;o.classList.add("srfm-active"),await fieldValidation(r,t,s,e)?o.classList.remove("srfm-active"):(l=await submitFormData(e),o.classList.add("srfm-active"),l?"message"===n?showSuccessMessage(c,e):redirectToUrl(a):showErrorMessage(i))}catch(e){o.classList.remove("srfm-active"),showErrorMessage(i)}}function extractFormAttributesAndElements(e){var r=e.getAttribute("form-id"),t=e.getAttribute("message-type"),s=e.getAttribute("success-url"),o=e.getAttribute("ajaxurl"),a=e.getAttribute("nonce"),c=e.querySelector(".srfm-loader"),i=e.nextElementSibling,n=e.querySelector(".srfm-error-message"),e=e.querySelector("#srfm-submit-btn"),l=e.getAttribute("data-sitekey"),m=e.getAttribute("recaptcha-type");return{formId:r,submitType:t,successUrl:s,ajaxUrl:o,nonce:a,loader:c,successMessage:i,errorMessage:n,submitBtn:e,siteKey:l,recaptchaType:m}}function onloadCallback(){Array.from(document.querySelectorAll(".srfm-form")).forEach(e=>{const{formId:r,submitType:t,successUrl:s,ajaxUrl:o,nonce:a,loader:c,successMessage:i,errorMessage:n,submitBtn:l,siteKey:m,recaptchaType:u}=extractFormAttributesAndElements(e);let f=!1;"v2-invisible"===u&&(grecaptcha.render(l,{sitekey:m,callback:()=>{handleFormSubmission(e,r,o,a,c,s,i,n,t),f=!0}}),l.addEventListener("click",()=>{f&&handleFormSubmission(e,r,o,a,c,s,i,n,t)}))})}document.addEventListener("DOMContentLoaded",function(){for(const r of Array.from(document.querySelectorAll(".srfm-form"))){const{formId:t,submitType:s,successUrl:o,ajaxUrl:a,nonce:c,loader:i,successMessage:n,errorMessage:l,submitBtn:e,siteKey:m,recaptchaType:u}=extractFormAttributesAndElements(r);"v3-reCAPTCHA"===u?e.addEventListener("click",e=>{e.preventDefault(),grecaptcha.ready(function(){grecaptcha.execute(m,{action:"submit"}).then(async function(e){e&&handleFormSubmission(r,t,a,c,i,o,n,l,s)})})}):r.addEventListener("submit",async function(e){e.preventDefault(),handleFormSubmission(r,t,a,c,i,o,n,l,s)})}});