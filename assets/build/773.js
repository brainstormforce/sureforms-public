/*! For license information please see 773.js.LICENSE.txt */
"use strict";(self.webpackChunksureforms=self.webpackChunksureforms||[]).push([[773],{773:function(t,e,r){r.r(e),r.d(e,{sc_paypal_buttons:function(){return d}});var n=r(7492),i=r(9988),s=r(1479);function o(t,e){void 0===e&&(e={});var r=document.createElement("script");return r.src=t,Object.keys(e).forEach((function(t){r.setAttribute(t,e[t]),"data-csp-nonce"===t&&r.setAttribute("nonce",e["data-csp-nonce"])})),r}function a(t,e){if(void 0===e&&(e=c()),l(t,e),"undefined"==typeof window)return e.resolve(null);var r=function(t){var e="https://www.paypal.com/sdk/js";t.sdkBaseURL&&(e=t.sdkBaseURL,delete t.sdkBaseURL),function(t){var e=t["merchant-id"],r=t["data-merchant-id"],n="",i="";Array.isArray(e)?e.length>1?(n="*",i=e.toString()):n=e.toString():"string"==typeof e&&e.length>0?n=e:"string"==typeof r&&r.length>0&&(n="*",i=r),t["merchant-id"]=n,t["data-merchant-id"]=i}(t);var r,n,i=Object.keys(t).filter((function(e){return void 0!==t[e]&&null!==t[e]&&""!==t[e]})).reduce((function(e,r){var n=t[r].toString();return"data-"===r.substring(0,5)?e.dataAttributes[r]=n:e.queryParams[r]=n,e}),{queryParams:{},dataAttributes:{}}),s=i.queryParams,o=i.dataAttributes;return{url:"".concat(e,"?").concat((r=s,n="",Object.keys(r).forEach((function(t){0!==n.length&&(n+="&"),n+=t+"="+r[t]})),n)),dataAttributes:o}}(t),n=r.url,i=r.dataAttributes,s=i["data-namespace"]||"paypal",a=u(s);return function(t,e){var r=document.querySelector('script[src="'.concat(t,'"]'));if(null===r)return null;var n=o(t,e),i=r.cloneNode();if(delete i.dataset.uidAuto,Object.keys(i.dataset).length!==Object.keys(n.dataset).length)return null;var s=!0;return Object.keys(i.dataset).forEach((function(t){i.dataset[t]!==n.dataset[t]&&(s=!1)})),s?r:null}(n,i)&&a?e.resolve(a):function(t,e){void 0===e&&(e=c()),l(t,e);var r=t.url,n=t.attributes;if("string"!=typeof r||0===r.length)throw new Error("Invalid url.");if(void 0!==n&&"object"!=typeof n)throw new Error("Expected attributes to be an object.");return new e((function(t,e){if("undefined"==typeof window)return t();!function(t){var e=t.onSuccess,r=t.onError,n=o(t.url,t.attributes);n.onerror=r,n.onload=e,document.head.insertBefore(n,document.head.firstElementChild)}({url:r,attributes:n,onSuccess:function(){return t()},onError:function(){var t=new Error('The script "'.concat(r,'" failed to load.'));return window.fetch?fetch(r).then((function(r){return 200===r.status&&e(t),r.text()})).then((function(t){var r=function(t){var e=t.split("/* Original Error:")[1];return e?e.replace(/\n/g,"").replace("*/","").trim():t}(t);e(new Error(r))})).catch((function(t){e(t)})):e(t)}})}))}({url:n,attributes:i},e).then((function(){var t=u(s);if(t)return t;throw new Error("The window.".concat(s," global variable is not available."))}))}function c(){if("undefined"==typeof Promise)throw new Error("Promise is undefined. To resolve the issue, use a Promise polyfill.");return Promise}function u(t){return window[t]}function l(t,e){if("object"!=typeof t||null===t)throw new Error("Expected an options object.");if(void 0!==e&&"function"!=typeof e)throw new Error("Expected PromisePonyfill to be a function.")}r(7094);const d=class{constructor(t){(0,n.r)(this,t),this.scError=(0,n.c)(this,"scError",7),this.scSetState=(0,n.c)(this,"scSetState",7),this.scPaid=(0,n.c)(this,"scPaid",7),this.busy=!1,this.buttons=["paypal","card"],this.label="paypal",this.color="gold"}async loadScript(){var t;if(this.clientId&&this.merchantId)try{const e=await a({"client-id":this.clientId.replace(/ /g,""),"merchant-id":this.merchantId,commit:!1,vault:!0,currency:(null===(t=this.order)||void 0===t?void 0:t.currency.toUpperCase())||"USD"});this.renderButtons(e)}catch(t){console.error("failed to load the PayPal JS SDK script",t)}}componentDidLoad(){this.loadScript()}renderButtons(t){const e={onClick:async(t,e)=>{const r=this.el.closest("sc-checkout");return await r.validate()?e.resolve():e.reject()},onInit:()=>{this.loaded=!0},onCancel:()=>{this.scSetState.emit("REJECT")},createOrder:async()=>new Promise((async(t,e)=>{var r,n;const s=this.el.closest("sc-checkout"),o=await s.submit();return o instanceof Error?e(o):"finalized"!==(null==o?void 0:o.status)?e(new Error("Something went wrong. Please try again.")):(null===(r=null==o?void 0:o.payment_intent)||void 0===r?void 0:r.external_intent_id)?t(null===(n=null==o?void 0:o.payment_intent)||void 0===n?void 0:n.external_intent_id):(this.scError.emit({code:"missing_payment_intent",message:(0,i._)("Something went wrong. Please contact us for payment.","surecart")}),e())})),onApprove:async()=>{var t,e;try{const r=await(0,s.a)({method:"PATCH",path:`surecart/v1/payment_intents/${null===(e=null===(t=this.order)||void 0===t?void 0:t.payment_intent)||void 0===e?void 0:e.id}/capture`});["succeeded","pending"].includes(null==r?void 0:r.status)?this.scPaid.emit():(this.scError.emit({code:"could_not_capture",message:(0,i._)("The payment did not process. Please try again.","surecart")}),this.scSetState.emit("REJECT"))}catch(t){console.error(t),this.scError.emit({code:"could_not_capture",message:(0,i._)("The payment did not process. Please try again.","surecart")}),this.scSetState.emit("REJECT")}},onError:t=>{this.scError.emit({code:null==t?void 0:t.code,message:null==t?void 0:t.message}),this.scSetState.emit("REJECT")}};if(t.FUNDING.PAYPAL){const r=t.Buttons({fundingSource:t.FUNDING.PAYPAL,style:{label:this.label,color:this.color},...e});r.isEligible()&&r.render(this.paypalContainer)}if(t.FUNDING.CARD){const r=t.Buttons({fundingSource:t.FUNDING.CARD,style:{color:"black"},...e});r.isEligible()&&r.render(this.cardContainer)}}render(){return(0,n.h)("div",{class:{"paypal-buttons":!0,"paypal-buttons--busy":this.busy}},(!this.loaded||this.busy)&&(0,n.h)("sc-skeleton",{style:{height:"55px","--border-radius":"4px",cursor:"wait"}}),(0,n.h)("div",{class:"sc-paypal-button-container",hidden:!this.loaded||this.busy},(0,n.h)("div",{hidden:!this.buttons.includes("card"),class:"sc-paypal-card-button",ref:t=>this.cardContainer=t}),(0,n.h)("div",{hidden:!this.buttons.includes("paypal"),class:"sc-paypal-button",ref:t=>this.paypalContainer=t})))}get el(){return(0,n.g)(this)}};d.style=":host{display:block}.paypal-buttons{position:relative}"}}]);
//# sourceMappingURL=773.js.map