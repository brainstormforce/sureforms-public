{"version":3,"file":"3461.js","mappings":"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","sources":["webpack://sureforms/./node_modules/@surecart/components/dist/esm/form-data-955eabfd.js","webpack://sureforms/./node_modules/@surecart/components/dist/esm/index-13d9a120.js","webpack://sureforms/./node_modules/@surecart/components/dist/esm/sc-form-components-validator_6.entry.js"],"sourcesContent":["class FormSubmitController {\n  constructor(input, options) {\n    this.form = null;\n    this.input = input;\n    this.options = {\n      form: (input) => { var _a, _b; return ((_b = (_a = this.closestElement('sc-form', input)) === null || _a === void 0 ? void 0 : _a.shadowRoot) === null || _b === void 0 ? void 0 : _b.querySelector('form')) || this.closestElement('form', input); },\n      name: (input) => input.name,\n      value: (input) => input.value,\n      disabled: (input) => input.disabled,\n      ...options,\n    };\n    this.form = this.options.form(this.input);\n    this.handleFormData = this.handleFormData.bind(this);\n  }\n  closestElement(selector, el) {\n    if (!el)\n      return null;\n    return (el && el != document && el != window && el.closest(selector)) || this.closestElement(selector, el.getRootNode().host);\n  }\n  addFormData() {\n    if (!this.form)\n      return;\n    this.form.addEventListener('formdata', this.handleFormData);\n  }\n  removeFormData() {\n    if (!this.form)\n      return;\n    this.form.removeEventListener('formdata', this.handleFormData);\n  }\n  handleFormData(event) {\n    const disabled = this.options.disabled(this.input);\n    const name = this.options.name(this.input);\n    const value = this.options.value(this.input);\n    if (!disabled && typeof name === 'string' && typeof value !== 'undefined') {\n      if (Array.isArray(value)) {\n        value.forEach(val => {\n          if (val) {\n            event.formData.append(name, val.toString());\n          }\n        });\n      }\n      else {\n        if (value) {\n          event.formData.append(name, value.toString());\n        }\n      }\n    }\n  }\n}\nconst parseFormData = (data) => {\n  var _a;\n  const { email, name, password, shipping_city, shipping_country, shipping_line_1, shipping_line_2, shipping_postal_code, shipping_state, billing_city, billing_country, billing_line_1, billing_line_2, billing_postal_code, billing_state, 'tax_identifier.number_type': tax_number_type, 'tax_identifier.number': tax_number, ...rest } = data;\n  console.log({ data });\n  const shipping_address = {\n    ...(shipping_city ? { city: shipping_city } : {}),\n    ...(shipping_country ? { country: shipping_country } : {}),\n    ...(shipping_line_1 ? { line_1: shipping_line_1 } : {}),\n    ...(shipping_line_2 ? { line_2: shipping_line_2 } : {}),\n    ...(shipping_postal_code ? { postal_code: shipping_postal_code } : {}),\n    ...(shipping_state ? { state: shipping_state } : {}),\n  };\n  const billing_address = {\n    ...(billing_city ? { city: billing_city } : {}),\n    ...(billing_country ? { country: billing_country } : {}),\n    ...(billing_line_1 ? { line_1: billing_line_1 } : {}),\n    ...(billing_line_2 ? { line_2: billing_line_2 } : {}),\n    ...(billing_postal_code ? { postal_code: billing_postal_code } : {}),\n    ...(billing_state ? { state: billing_state } : {}),\n  };\n  return {\n    ...(name ? { name } : {}),\n    ...(email ? { email } : {}),\n    ...(password ? { password } : {}),\n    ...(Object.keys(shipping_address || {}).length ? { shipping_address } : {}),\n    ...(Object.keys(billing_address || {}).length ? { billing_address } : {}),\n    ...(tax_number_type && tax_number ? { tax_identifier: { number: tax_number, number_type: tax_number_type } } : {}),\n    ...(((_a = Object.keys(rest)) === null || _a === void 0 ? void 0 : _a.length) ? { metadata: rest } : {}),\n  };\n};\nconst reportChildrenValidity = async (element) => {\n  const items = [...element.shadowRoot.querySelectorAll('*')].filter((el) => typeof el.reportValidity === 'function');\n  for (const el of items) {\n    const isValid = await el.reportValidity();\n    if (!isValid) {\n      return false;\n    }\n  }\n  return true;\n};\n\nexport { FormSubmitController as F, parseFormData as p, reportChildrenValidity as r };\n","import { a as apiFetch } from './fetch-d56a3ec0.js';\nimport { a as addQueryArgs } from './add-query-args-f4c5962b.js';\n\nconst baseUrl = 'surecart/v1/orders/';\nconst expand = [\n  'line_items',\n  'line_item.price',\n  'price.product',\n  'customer',\n  'customer.shipping_address',\n  'payment_intent',\n  'discount',\n  'discount.promotion',\n  'discount.coupon',\n  'shipping_address',\n  'tax_identifier',\n];\nconst parsePath = (id, endpoint = '') => {\n  let path = id ? `${baseUrl}${id}` : baseUrl;\n  path = `${path}${endpoint}`;\n  return addQueryArgs(path, {\n    expand,\n  });\n};\nconst createOrUpdateOrder = async ({ id, data, query = {} }) => {\n  return await apiFetch({\n    method: id ? 'PATCH' : 'POST',\n    path: addQueryArgs(parsePath(id), query),\n    data,\n  });\n};\n/**\n * Finalize a checkout session\n */\nconst finalizeSession = async ({ id, data = {}, query = {}, processor }) => {\n  return (await apiFetch({\n    method: 'POST',\n    path: addQueryArgs(parsePath(id, `/finalize/`), {\n      processor_type: processor,\n      ...query,\n    }),\n    data,\n  }));\n};\n\nexport { createOrUpdateOrder as c, expand as e, finalizeSession as f };\n","import { r as registerInstance, h, g as getElement, c as createEvent, H as Host } from './index-430bb51b.js';\nimport { _ as __ } from './default-i18n-c67eee5a.js';\nimport { a as apiFetch, g as getQueryArg } from './fetch-d56a3ec0.js';\nimport { e as expand, f as finalizeSession, c as createOrUpdateOrder } from './index-13d9a120.js';\nimport { p as parseFormData } from './form-data-955eabfd.js';\nimport { g as getQueryArgs, b as buildQueryString, a as addQueryArgs } from './add-query-args-f4c5962b.js';\nimport './_commonjsHelpers-9943807e.js';\n\n/**\n * Internal dependencies\n */\n/**\n * Removes arguments from the query string of the url\n *\n * @param {string}    url  URL.\n * @param {...string} args Query Args.\n *\n * @example\n * ```js\n * const newUrl = removeQueryArgs( 'https://wordpress.org?foo=bar&bar=baz&baz=foobar', 'foo', 'bar' ); // https://wordpress.org?baz=foobar\n * ```\n *\n * @return {string} Updated URL.\n */\n\nfunction removeQueryArgs(url) {\n  const queryStringIndex = url.indexOf('?');\n\n  if (queryStringIndex === -1) {\n    return url;\n  }\n\n  const query = getQueryArgs(url);\n  const baseURL = url.substr(0, queryStringIndex);\n\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  args.forEach(arg => delete query[arg]);\n  const queryString = buildQueryString(query);\n  return queryString ? baseURL + '?' + queryString : baseURL;\n}\n\nconst ScFormComponentsValidator = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n  }\n  handleOrderChange() {\n    var _a, _b;\n    // bail if we don't have address invalid error or disabled.\n    if (this.disabled)\n      return;\n    // make sure to add the address field if it's not there.\n    if (((_a = this === null || this === void 0 ? void 0 : this.order) === null || _a === void 0 ? void 0 : _a.tax_status) === 'address_invalid' || ((_b = this === null || this === void 0 ? void 0 : this.order) === null || _b === void 0 ? void 0 : _b.shipping_enabled)) {\n      this.addAddressField();\n    }\n  }\n  componentWillLoad() {\n    this.hasAddress = !!this.el.querySelector('sc-order-shipping-address');\n    // automatically add address field if tax is enabled.\n    if (this.taxEnabled) {\n      this.addAddressField();\n    }\n  }\n  addAddressField() {\n    if (this.hasAddress)\n      return;\n    const payment = this.el.querySelector('sc-payment');\n    const address = document.createElement('sc-order-shipping-address');\n    address.label = __('Address', 'surecart');\n    payment.parentNode.insertBefore(address, payment);\n    this.hasAddress = true;\n  }\n  render() {\n    return h(\"slot\", null);\n  }\n  get el() { return getElement(this); }\n  static get watchers() { return {\n    \"order\": [\"handleOrderChange\"]\n  }; }\n};\n\nconst ScFormErrorProvider = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.scUpdateError = createEvent(this, \"scUpdateError\", 7);\n    this.scSetState = createEvent(this, \"scSetState\", 7);\n  }\n  /** Trigger the error event when an error happens  */\n  handleErrorUpdate(val) {\n    this.scUpdateError.emit(val);\n  }\n  handleOrderChange() {\n    this.error = null;\n  }\n  /** Listen for error events in component. */\n  handleErrorEvent(e) {\n    this.error = e.detail;\n    if (Object.keys((e === null || e === void 0 ? void 0 : e.detail) || {}).length) {\n      this.scSetState.emit('REJECT'); // make sure we are rejecting the current state.\n    }\n  }\n  /** Listen for pay errors. */\n  handlePayError(e) {\n    var _a;\n    this.error = ((_a = e.detail) === null || _a === void 0 ? void 0 : _a.message) || {\n      code: '',\n      message: 'Something went wrong with your payment.',\n    };\n  }\n  /** This filters the error message with some more client friendly error messages. */\n  getErrorMessage(error) {\n    if (error.code === 'order.line_items.price.blank') {\n      return __('This product is no longer purchasable.', 'surecart');\n    }\n    return error === null || error === void 0 ? void 0 : error.message;\n  }\n  /** First will display validation error, then main error if no validation errors. */\n  errorMessage() {\n    var _a, _b, _c, _d, _e, _f;\n    if ((_c = (_b = (_a = this.error) === null || _a === void 0 ? void 0 : _a.additional_errors) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.message) {\n      return this.getErrorMessage((_e = (_d = this.error) === null || _d === void 0 ? void 0 : _d.additional_errors) === null || _e === void 0 ? void 0 : _e[0]);\n    }\n    else if ((_f = this === null || this === void 0 ? void 0 : this.error) === null || _f === void 0 ? void 0 : _f.message) {\n      return this.getErrorMessage(this === null || this === void 0 ? void 0 : this.error);\n    }\n    return '';\n  }\n  render() {\n    return (h(Host, null, !!this.errorMessage() && (h(\"sc-alert\", { type: \"danger\", scrollOnOpen: true, open: !!this.errorMessage() }, h(\"span\", { slot: \"title\" }, this.errorMessage()))), h(\"slot\", null)));\n  }\n  static get watchers() { return {\n    \"error\": [\"handleErrorUpdate\"],\n    \"order\": [\"handleOrderChange\"]\n  }; }\n};\n\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\nfunction t(t,n){var e=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)a.push(r.value);}catch(t){o={error:t};}finally{try{r&&!r.done&&(e=i.return)&&e.call(i);}finally{if(o)throw o.error}}return a}var n;!function(t){t[t.NotStarted=0]=\"NotStarted\",t[t.Running=1]=\"Running\",t[t.Stopped=2]=\"Stopped\";}(n||(n={}));var e={type:\"xstate.init\"};function r(t){return void 0===t?[]:[].concat(t)}function o(t){return {type:\"xstate.assign\",assignment:t}}function i(t,n){return \"string\"==typeof(t=\"string\"==typeof t&&n&&n[t]?n[t]:t)?{type:t}:\"function\"==typeof t?{type:t.name,exec:t}:t}function a(t){return function(n){return t===n}}function u(t){return \"string\"==typeof t?{type:t}:t}function c(t,n){return {value:t,context:n,actions:[],changed:!1,matches:a(t)}}function f(t,n,e){var r=n,o=!1;return [t.filter((function(t){if(\"xstate.assign\"===t.type){o=!0;var n=Object.assign({},r);return \"function\"==typeof t.assignment?n=t.assignment(r,e):Object.keys(t.assignment).forEach((function(o){n[o]=\"function\"==typeof t.assignment[o]?t.assignment[o](r,e):t.assignment[o];})),r=n,!1}return !0})),r,o]}function s(n,o){void 0===o&&(o={});var s=t(f(r(n.states[n.initial].entry).map((function(t){return i(t,o.actions)})),n.context,e),2),l=s[0],v=s[1],y={config:n,_options:o,initialState:{value:n.initial,actions:l,context:v,matches:a(n.initial)},transition:function(e,o){var s,l,v=\"string\"==typeof e?{value:e,context:n.context}:e,p=v.value,g=v.context,d=u(o),x=n.states[p];if(x.on){var m=r(x.on[d.type]);try{for(var h=function(t){var n=\"function\"==typeof Symbol&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&\"number\"==typeof t.length)return {next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}(m),b=h.next();!b.done;b=h.next()){var S=b.value;if(void 0===S)return c(p,g);var w=\"string\"==typeof S?{target:S}:S,j=w.target,E=w.actions,R=void 0===E?[]:E,N=w.cond,O=void 0===N?function(){return !0}:N,_=void 0===j,k=null!=j?j:p,T=n.states[k];if(O(g,d)){var q=t(f((_?r(R):[].concat(x.exit,R,T.entry).filter((function(t){return t}))).map((function(t){return i(t,y._options.actions)})),g,d),3),z=q[0],A=q[1],B=q[2],C=null!=j?j:p;return {value:C,context:A,actions:z,changed:j!==p||z.length>0||B,matches:a(C)}}}}catch(t){s={error:t};}finally{try{b&&!b.done&&(l=h.return)&&l.call(h);}finally{if(s)throw s.error}}}return c(p,g)}};return y}var l=function(t,n){return t.actions.forEach((function(e){var r=e.exec;return r&&r(t.context,n)}))};function v(t){var r=t.initialState,o=n.NotStarted,i=new Set,c={_machine:t,send:function(e){o===n.Running&&(r=t.transition(r,e),l(r,u(e)),i.forEach((function(t){return t(r)})));},subscribe:function(t){return i.add(t),t(r),{unsubscribe:function(){return i.delete(t)}}},start:function(i){if(i){var u=\"object\"==typeof i?i:{context:t.config.context,value:i};r={value:u.value,actions:[],context:u.context,matches:a(u.value)};}return o=n.Running,l(r,e),c},stop:function(){return o=n.Stopped,i.clear(),c},get state(){return r},get status(){return o}};return c}\n\nconst checkoutMachine = s({\n  id: 'fetch',\n  initial: 'idle',\n  context: {\n    retries: 3,\n  },\n  states: {\n    idle: {\n      on: {\n        FETCH: 'loading',\n      },\n    },\n    loading: {\n      on: {\n        RESOLVE: 'draft',\n        REJECT: 'failure',\n        EXPIRE: 'expired',\n        PAID: 'paid',\n      },\n    },\n    draft: {\n      on: {\n        FINALIZE: 'finalizing',\n        FETCH: 'updating',\n        REJECT: 'draft',\n      },\n    },\n    updating: {\n      on: {\n        RESOLVE: 'draft',\n        EXPIRE: 'expired',\n        REJECT: 'draft',\n      },\n    },\n    finalizing: {\n      on: {\n        PAID: 'paid',\n        REJECT: 'draft',\n      },\n    },\n    paid: {\n      on: {\n        CONFIRMED: 'confirmed',\n        REJECT: 'draft',\n      },\n    },\n    expired: {},\n    confirmed: {},\n    failure: {\n      on: {\n        RETRY: {\n          target: 'loading',\n          actions: o({\n            retries: (context) => context.retries + 1,\n          }),\n        },\n      },\n    },\n  },\n});\n\nconst ScFormStateProvider = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.scSetCheckoutFormState = createEvent(this, \"scSetCheckoutFormState\", 7);\n    /** Holds our state machine service */\n    this._stateService = v(checkoutMachine);\n    /** Loading states for different parts of the form. */\n    this.checkoutState = checkoutMachine.initialState;\n  }\n  /** Set the state. */\n  setState(name) {\n    const { send } = this._stateService;\n    return send(name);\n  }\n  /** Watch for checkout state changes and emit to listeners. */\n  handleCheckoutStateChange(state) {\n    this.scSetCheckoutFormState.emit(state.value);\n  }\n  /** Init the state service. */\n  componentWillLoad() {\n    // Start state machine.\n    this._stateService.subscribe(state => (this.checkoutState = state));\n    this._stateService.start();\n  }\n  /** Remove state machine on disconnect. */\n  disconnectedCallback() {\n    this._stateService.stop();\n  }\n  /** Allow children to set the form state. */\n  handleSetStateEvent(e) {\n    this.setState(e.detail);\n  }\n  /** Update the state when the order is paid. */\n  async handlePaid() {\n    this.setState('PAID');\n  }\n  /** Update the state when the order is paid. */\n  async handleConfirmed() {\n    this.setState('CONFIRMED');\n  }\n  render() {\n    // handle expired.\n    if (this.checkoutState.value === 'expired') {\n      return (h(\"sc-block-ui\", null, h(\"div\", null, __('Please refresh the page.', 'surecart'))));\n    }\n    return h(\"slot\", null);\n  }\n  static get watchers() { return {\n    \"checkoutState\": [\"handleCheckoutStateChange\"]\n  }; }\n};\n\nconst ScOrderConfirmProvider = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.scUpdateOrderState = createEvent(this, \"scUpdateOrderState\", 7);\n    this.scConfirmed = createEvent(this, \"scConfirmed\", 7);\n    this.scOrderPaid = createEvent(this, \"scOrderPaid\", 7);\n    this.scError = createEvent(this, \"scError\", 7);\n  }\n  /** Listen for paid event. This is triggered by Stripe or Paypal elements when payment succeeds. */\n  handlePaidEvent() {\n    this.confirmOrder();\n  }\n  /** Confirm the order. */\n  async confirmOrder() {\n    var _a;\n    const json = await this.el.querySelector('sc-form').getFormJson();\n    let data = parseFormData(json);\n    try {\n      const confirmed = (await apiFetch({\n        method: 'PATCH',\n        path: addQueryArgs(`surecart/v1/orders/${(_a = this.order) === null || _a === void 0 ? void 0 : _a.id}/confirm`, [expand]),\n        data,\n      }));\n      // make sure we update the state in the central store.\n      this.scUpdateOrderState.emit(confirmed);\n      // emit the confirmed event to trigger listeners to redirect to the success url, etc.\n      this.scConfirmed.emit();\n      // emit the order paid event for tracking scripts.\n      this.scOrderPaid.emit(confirmed);\n    }\n    catch (e) {\n      console.error(e);\n      this.scError.emit(e);\n    }\n  }\n  render() {\n    return h(\"slot\", null);\n  }\n  get el() { return getElement(this); }\n};\n\nconst ScOrderRedirectProvider = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.scSetState = createEvent(this, \"scSetState\", 7);\n    this.scError = createEvent(this, \"scError\", 7);\n  }\n  /** Listen for when an order comes back as paid, then redirect. */\n  handleOrderPaid() {\n    var _a;\n    if (((_a = this.order) === null || _a === void 0 ? void 0 : _a.status) !== 'paid')\n      return;\n    this.scSetState.emit('PAID'); // make sure we are setting the correct state.\n    return this.redirect();\n  }\n  componentDidLoad() {\n    const successUrl = getQueryArg(window.location.href, 'success_url');\n    if (successUrl) {\n      this.successUrl = successUrl;\n    }\n    this.handleOrderPaid();\n  }\n  /** Redirect to the success url. */\n  redirect() {\n    window.location.assign(addQueryArgs(this.successUrl, { order: this.order.id }));\n  }\n  render() {\n    return h(\"slot\", null);\n  }\n  static get watchers() { return {\n    \"order\": [\"handleOrderPaid\"]\n  }; }\n};\n\nconst getURLLineItems = () => {\n  // check the url query first\n  return getQueryArg(window.location.href, 'line_items');\n};\nconst getURLCoupon = () => {\n  // check the url query first\n  return (getQueryArg(window.location.href, 'coupon') || '').toUpperCase();\n};\n/**\n * Attempt to get the session id\n *\n * @param formId The form id.\n * @param order The order\n * @param refresh Should we refresh?\n *\n * @returns string\n */\nconst getSessionId = (formId, order, modified) => {\n  // if we already have an ID set, return that:\n  if (order === null || order === void 0 ? void 0 : order.id) {\n    return order.id;\n  }\n  // check the url query first\n  const urlId = getQueryArg(window.location.href, 'order');\n  if (urlId) {\n    return urlId;\n  }\n  const savedModification = localStorage.getItem(`${formId}-modified`);\n  // nothing saved.\n  if (!savedModification) {\n    return window.localStorage.getItem(formId);\n  }\n  // this has not been modified, so return the saved session id.\n  if (modified && savedModification === modified) {\n    return window.localStorage.getItem(formId);\n  }\n  return '';\n};\nconst setSessionId = (formId, sessionId, modified) => {\n  window.localStorage.setItem(formId, sessionId);\n  window.localStorage.setItem(`${formId}-modified`, modified);\n};\nconst removeSessionId = formId => {\n  // check id in localstorage\n  return window.localStorage.removeItem(formId);\n};\n// find the input based on the unique name.\nconst findInput = (el, name) => {\n  var _a, _b;\n  const slot = (_b = (_a = el.querySelector('sc-form')) === null || _a === void 0 ? void 0 : _a.shadowRoot) === null || _b === void 0 ? void 0 : _b.querySelector('slot');\n  if (!slot)\n    return;\n  return slot\n    .assignedElements({ flatten: true })\n    .reduce((all, el) => all.concat(el, [...el.querySelectorAll('*')]), [])\n    .find((el) => el.name === name);\n};\nconst populateInputs = (el, order) => {\n  // handle our own built-in inputs.\n  const names = ['name', 'email'];\n  // handle our our inputs.\n  names.forEach(name => {\n    const input = findInput(el, name);\n    if (!input || !order[name])\n      return;\n    input.value = order[name];\n  });\n  // update metadata.\n  Object.keys((order === null || order === void 0 ? void 0 : order.metadata) || {}).forEach(key => {\n    const input = findInput(el, key);\n    if (!input || !order.metadata[key])\n      return;\n    input.value = order.metadata[key];\n  });\n};\n\nconst ScSessionProvider = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.scUpdateOrderState = createEvent(this, \"scUpdateOrderState\", 7);\n    this.scUpdateDraftState = createEvent(this, \"scUpdateDraftState\", 7);\n    this.scError = createEvent(this, \"scError\", 7);\n    this.scSetState = createEvent(this, \"scSetState\", 7);\n    /** Are we in test or live mode. */\n    this.mode = 'live';\n    /** An array of prices to pre-fill in the form. */\n    this.prices = [];\n    /** Currency Code */\n    this.currencyCode = 'usd';\n    /** The processor. */\n    this.processor = 'stripe';\n  }\n  /** Sync this session back to parent. */\n  handleSessionUpdate(val) {\n    this.scUpdateOrderState.emit(val);\n  }\n  /** Store checkout session in localstorage */\n  handleOrderChange(val) {\n    if (val === null || val === void 0 ? void 0 : val.id) {\n      setSessionId(this.groupId, val.id, this.modified);\n    }\n    if (val.status === 'paid') {\n      removeSessionId(this.groupId);\n    }\n    /** Populate any inputs from the session */\n    populateInputs(this.el, val);\n  }\n  handleUpdateSession(e) {\n    const { data, options } = e.detail;\n    if (options === null || options === void 0 ? void 0 : options.silent) {\n      this.update({ ...this.defaultFormData(), ...data });\n    }\n    else {\n      this.loadUpdate(data);\n    }\n  }\n  handlePricesChange() {\n    let line_items = this.addInitialPrices() || [];\n    line_items = this.addPriceChoices(line_items);\n    if (!(line_items === null || line_items === void 0 ? void 0 : line_items.length)) {\n      return;\n    }\n    return this.loadUpdate({ line_items });\n  }\n  /**\n   * Finalize the order.\n   *\n   * @returns {Promise<Order>}\n   */\n  async finalize() {\n    return await this.handleFormSubmit();\n  }\n  getProcessor() {\n    switch (this.processor) {\n      case 'paypal':\n      case 'paypal-card':\n        return 'paypal';\n      default:\n        return 'stripe';\n    }\n  }\n  getPaymentIntent() {\n    var _a;\n    const processor_type = this.getProcessor();\n    return (_a = this.paymentIntents) === null || _a === void 0 ? void 0 : _a[processor_type];\n  }\n  /**\n   * Handles the form submission.\n   * @param e\n   */\n  async handleFormSubmit() {\n    var _a, _b, _c, _d;\n    this.scError.emit({});\n    const payment_intent = this.getPaymentIntent();\n    this.scSetState.emit('FINALIZE');\n    // Get current form state.\n    const json = await this.el.querySelector('sc-form').getFormJson();\n    let data = parseFormData(json);\n    // first lets make sure the session is updated before we process it.\n    try {\n      await this.update({ ...this.defaultFormData(), ...data });\n    }\n    catch (e) {\n      console.error(e);\n      this.scSetState.emit('REJECT');\n      this.handleErrorResponse(e);\n    }\n    // Important: Stripe needs a payment intent ahead of time, or the\n    // order will not be attached to the payment.\n    if (this.session.total_amount > 0 && !payment_intent && this.getProcessor() === 'stripe' && this.stripePaymentElement) {\n      this.scError.emit({ message: 'Something went wrong. Please try again.' });\n      console.error('No payment intent found.');\n      return this.scSetState.emit('REJECT');\n    }\n    // first validate server-side and get key\n    try {\n      const order = await finalizeSession({\n        id: this.order.id,\n        data,\n        query: {\n          ...this.defaultFormQuery(),\n          ...((payment_intent === null || payment_intent === void 0 ? void 0 : payment_intent.id) ? { payment_intent_id: payment_intent === null || payment_intent === void 0 ? void 0 : payment_intent.id } : {}),\n        },\n        processor: this.getProcessor(),\n      });\n      // payment intent must match what we sent to make sure it's attached to an order.\n      if (this.session.total_amount > 0 && (payment_intent === null || payment_intent === void 0 ? void 0 : payment_intent.id) && ((_a = order === null || order === void 0 ? void 0 : order.payment_intent) === null || _a === void 0 ? void 0 : _a.id) !== (payment_intent === null || payment_intent === void 0 ? void 0 : payment_intent.id)) {\n        console.error('Payment intent mismatch', payment_intent === null || payment_intent === void 0 ? void 0 : payment_intent.id, (_b = order === null || order === void 0 ? void 0 : order.payment_intent) === null || _b === void 0 ? void 0 : _b.id);\n        this.scError.emit({ message: 'Something went wrong. Please try again.' });\n        return this.scSetState.emit('REJECT');\n      }\n      this.session = order;\n      return this.session;\n    }\n    catch (e) {\n      // handle old price versions by refreshing.\n      if (((_d = (_c = e === null || e === void 0 ? void 0 : e.additional_errors) === null || _c === void 0 ? void 0 : _c[0]) === null || _d === void 0 ? void 0 : _d.code) === 'order.line_items.old_price_versions') {\n        await this.loadUpdate({\n          id: this.order.id,\n          data: {\n            status: 'draft',\n            refresh_price_versions: true,\n          },\n        });\n        return;\n      }\n      // make it a draft again and resubmit if status is incorrect.\n      if (['order.invalid_status_transition'].includes(e === null || e === void 0 ? void 0 : e.code)) {\n        await this.loadUpdate({\n          id: this.order.id,\n          data: {\n            status: 'draft',\n          },\n        });\n        this.handleFormSubmit();\n        return;\n      }\n      this.handleErrorResponse(e);\n    }\n  }\n  /**\n   * Handle paid event and update the\n   */\n  async handlePaid() {\n    this.scSetState.emit('PAID');\n  }\n  async handlePayError() {\n    this.scSetState.emit('REJECT');\n  }\n  /** Handles coupon updates. */\n  async handleCouponApply(e) {\n    const promotion_code = e.detail;\n    this.scError.emit({});\n    this.loadUpdate({\n      discount: {\n        ...(promotion_code ? { promotion_code } : {}),\n      },\n    });\n  }\n  /** Handle the error response. */\n  handleErrorResponse(e) {\n    // expired\n    if ((e === null || e === void 0 ? void 0 : e.code) === 'rest_cookie_invalid_nonce') {\n      this.scSetState.emit('EXPIRE');\n      return;\n    }\n    // paid\n    if ((e === null || e === void 0 ? void 0 : e.code) === 'readonly') {\n      removeSessionId(this.groupId);\n      window.location.assign(removeQueryArgs(window.location.href, 'order'));\n      return;\n    }\n    // something went wrong\n    if (e === null || e === void 0 ? void 0 : e.message) {\n      this.scError.emit(e);\n    }\n    // handle curl timeout errors.\n    if ((e === null || e === void 0 ? void 0 : e.code) === 'http_request_failed') {\n      this.scError.emit({ message: 'Something went wrong. Please reload the page and try again.' });\n    }\n    this.scSetState.emit('REJECT');\n  }\n  /** Default data always sent with the session. */\n  defaultFormData() {\n    var _a;\n    return {\n      return_url: window.top.location.href,\n      currency: ((_a = this.order) === null || _a === void 0 ? void 0 : _a.currency) || this.currencyCode,\n      live_mode: this.mode !== 'test',\n      group_key: this.groupId,\n    };\n  }\n  defaultFormQuery() {\n    return {\n      form_id: this.formId,\n    };\n  }\n  /** Find or create session on load. */\n  componentDidLoad() {\n    this.findOrCreateOrder();\n  }\n  /** Find or create an order */\n  findOrCreateOrder() {\n    var _a, _b, _c;\n    // get initial data from the url\n    const initial_data = this.getInitialDataFromUrl();\n    // remove from window\n    if ((_a = initial_data === null || initial_data === void 0 ? void 0 : initial_data.discount) === null || _a === void 0 ? void 0 : _a.promotion_code) {\n      window.history.replaceState({}, document.title, removeQueryArgs(window.location.href, 'coupon'));\n    }\n    if ((_b = initial_data === null || initial_data === void 0 ? void 0 : initial_data.line_items) === null || _b === void 0 ? void 0 : _b.length) {\n      window.history.replaceState({}, document.title, removeQueryArgs(window.location.href, 'line_items'));\n    }\n    // we have line items, don't load any existing session.\n    if ((_c = initial_data === null || initial_data === void 0 ? void 0 : initial_data.line_items) === null || _c === void 0 ? void 0 : _c.length) {\n      return this.fetch(initial_data);\n    }\n    // check if we have an existing session.\n    const id = getSessionId(this.groupId, this.order, this.modified);\n    // fetch or initialize a session.\n    return id && this.persist ? this.fetch(initial_data) : this.initialize(initial_data);\n  }\n  getInitialDataFromUrl() {\n    let initial_data = {};\n    // Coupon code.\n    const promotion_code = getURLCoupon();\n    initial_data = {\n      ...initial_data,\n      ...(promotion_code ? { discount: { promotion_code } } : {}),\n    };\n    // Line items.\n    const line_items = getURLLineItems();\n    initial_data = {\n      ...initial_data,\n      ...(line_items && (line_items === null || line_items === void 0 ? void 0 : line_items.length) ? { line_items } : {}),\n    };\n    return initial_data;\n  }\n  /** Looks through children and finds items needed for initial session. */\n  async initialize(args = {}) {\n    let line_items = this.addInitialPrices() || [];\n    line_items = this.addPriceChoices(line_items);\n    if (line_items === null || line_items === void 0 ? void 0 : line_items.length) {\n      return this.loadUpdate({ line_items, ...args });\n    }\n    else {\n      return this.loadUpdate({ ...args });\n    }\n  }\n  /** Add prices that are passed into the component. */\n  addInitialPrices() {\n    var _a;\n    if (!((_a = this === null || this === void 0 ? void 0 : this.prices) === null || _a === void 0 ? void 0 : _a.length))\n      return [];\n    // check for id\n    if (this.prices.some(p => !(p === null || p === void 0 ? void 0 : p.id))) {\n      return;\n    }\n    // add prices that are passed into this component.\n    return this.prices.map(price => {\n      return {\n        price_id: price.id,\n        quantity: price.quantity,\n      };\n    });\n  }\n  /** Add default prices that may be selected in form. */\n  addPriceChoices(line_items = []) {\n    const elements = this.el.querySelectorAll('[price-id]');\n    elements.forEach(el => {\n      // handle price choices.\n      if (el.checked) {\n        line_items.push({\n          quantity: el.quantity || 1,\n          price_id: el.priceId,\n          ...(el.defaultAmount ? { ad_hoc_amount: el.defaultAmount } : {}),\n        });\n      }\n      // handle donation default amount.\n      if (el.defaultAmount) {\n        line_items.push({\n          quantity: el.quantity || 1,\n          price_id: el.priceId,\n          ad_hoc_amount: el.defaultAmount,\n        });\n      }\n    });\n    return line_items;\n  }\n  getSessionId() {\n    var _a;\n    if ((_a = this.order) === null || _a === void 0 ? void 0 : _a.id) {\n      return this.order.id;\n    }\n    const id = getSessionId(this.groupId, this.order, this.modified);\n    if (this.persist) {\n      return id;\n    }\n  }\n  /** Fetch a session. */\n  async fetch(args = {}) {\n    this.loadUpdate({ status: 'draft', ...args });\n  }\n  /** Update a session */\n  async update(data = {}, query = {}) {\n    try {\n      this.session = (await createOrUpdateOrder({\n        id: this.getSessionId(),\n        data: {\n          ...this.defaultFormData(),\n          ...data,\n        },\n        query: {\n          ...this.defaultFormQuery(),\n          ...query,\n        },\n      }));\n    }\n    catch (e) {\n      // reinitalize if order not found.\n      if (['order.not_found'].includes(e === null || e === void 0 ? void 0 : e.code)) {\n        removeSessionId(this.groupId);\n        return this.initialize();\n      }\n      console.error(e);\n      throw e;\n    }\n  }\n  /** Updates a session with loading status changes. */\n  async loadUpdate(data = {}) {\n    try {\n      this.scSetState.emit('FETCH');\n      await this.update({ ...this.defaultFormData(), ...data });\n      this.scSetState.emit('RESOLVE');\n    }\n    catch (e) {\n      this.handleErrorResponse(e);\n    }\n  }\n  render() {\n    return (h(\"sc-line-items-provider\", { order: this.order, onScUpdateLineItems: e => this.loadUpdate({ line_items: e.detail }) }, h(\"slot\", null)));\n  }\n  get el() { return getElement(this); }\n  static get watchers() { return {\n    \"session\": [\"handleSessionUpdate\"],\n    \"order\": [\"handleOrderChange\"],\n    \"prices\": [\"handlePricesChange\"]\n  }; }\n};\n\nexport { ScFormComponentsValidator as sc_form_components_validator, ScFormErrorProvider as sc_form_error_provider, ScFormStateProvider as sc_form_state_provider, ScOrderConfirmProvider as sc_order_confirm_provider, ScOrderRedirectProvider as sc_order_redirect_provider, ScSessionProvider as sc_session_provider };\n"],"names":["FormSubmitController","constructor","input","options","this","form","_a","_b","closestElement","shadowRoot","querySelector","name","value","disabled","handleFormData","bind","selector","el","document","window","closest","getRootNode","host","addFormData","addEventListener","removeFormData","removeEventListener","event","Array","isArray","forEach","val","formData","append","toString","parseFormData","data","email","password","shipping_city","shipping_country","shipping_line_1","shipping_line_2","shipping_postal_code","shipping_state","billing_city","billing_country","billing_line_1","billing_line_2","billing_postal_code","billing_state","tax_number_type","tax_number","rest","console","log","shipping_address","city","country","line_1","line_2","postal_code","state","billing_address","Object","keys","length","tax_identifier","number","number_type","metadata","reportChildrenValidity","async","element","items","querySelectorAll","filter","reportValidity","baseUrl","expand","parsePath","id","endpoint","path","a","createOrUpdateOrder","query","method","finalizeSession","processor","processor_type","removeQueryArgs","url","queryStringIndex","indexOf","g","baseURL","substr","_len","arguments","args","_key","arg","queryString","b","ScFormComponentsValidator","hostRef","r","handleOrderChange","order","tax_status","shipping_enabled","addAddressField","componentWillLoad","hasAddress","taxEnabled","payment","address","createElement","label","_","parentNode","insertBefore","render","h","watchers","ScFormErrorProvider","scUpdateError","c","scSetState","handleErrorUpdate","emit","error","handleErrorEvent","e","detail","handlePayError","message","code","getErrorMessage","errorMessage","_c","_d","_e","_f","additional_errors","H","type","scrollOnOpen","open","slot","t","n","Symbol","iterator","o","i","call","next","done","push","return","NotStarted","Running","Stopped","concat","exec","u","context","actions","changed","matches","f","assign","assignment","l","checkoutMachine","s","states","initial","entry","map","v","y","config","_options","initialState","transition","p","d","x","on","m","TypeError","S","w","target","j","E","R","N","cond","O","T","q","exit","z","A","B","C","retries","idle","FETCH","loading","RESOLVE","REJECT","EXPIRE","PAID","draft","FINALIZE","updating","finalizing","paid","CONFIRMED","expired","confirmed","failure","RETRY","ScFormStateProvider","scSetCheckoutFormState","_stateService","Set","_machine","send","subscribe","add","unsubscribe","delete","start","stop","clear","status","checkoutState","setState","handleCheckoutStateChange","disconnectedCallback","handleSetStateEvent","ScOrderConfirmProvider","scUpdateOrderState","scConfirmed","scOrderPaid","scError","handlePaidEvent","confirmOrder","json","getFormJson","ScOrderRedirectProvider","handleOrderPaid","redirect","componentDidLoad","successUrl","location","href","getSessionId","formId","modified","urlId","savedModification","localStorage","getItem","removeSessionId","removeItem","findInput","assignedElements","flatten","reduce","all","find","ScSessionProvider","scUpdateDraftState","mode","prices","currencyCode","handleSessionUpdate","sessionId","groupId","setItem","key","handleUpdateSession","silent","update","defaultFormData","loadUpdate","handlePricesChange","line_items","addInitialPrices","addPriceChoices","handleFormSubmit","getProcessor","getPaymentIntent","paymentIntents","payment_intent","handleErrorResponse","session","total_amount","stripePaymentElement","defaultFormQuery","payment_intent_id","refresh_price_versions","includes","promotion_code","discount","return_url","top","currency","live_mode","group_key","form_id","findOrCreateOrder","initial_data","getInitialDataFromUrl","history","replaceState","title","persist","fetch","initialize","toUpperCase","some","price","price_id","quantity","checked","priceId","defaultAmount","ad_hoc_amount","onScUpdateLineItems"],"sourceRoot":""}