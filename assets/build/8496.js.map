{"version":3,"file":"8496.js","mappings":"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","sources":["webpack://sureforms/./node_modules/@surecart/components/dist/esm/consumer-1db89974.js","webpack://sureforms/./node_modules/@surecart/components/dist/esm/sc-donation-choices.entry.js"],"sourcesContent":["import { g as getElement } from './index-430bb51b.js';\n\nvar createDeferredPromise = function () {\n    var resolve;\n    var promise = new Promise(function (res) { resolve = res; });\n    return { promise: promise, resolve: resolve };\n};\n\nvar openWormhole = function (Component, props, isBlocking) {\n    if (isBlocking === void 0) { isBlocking = true; }\n    var isConstructor = (Component.constructor.name === 'Function');\n    var Proto = isConstructor ? Component.prototype : Component;\n    var componentWillLoad = Proto.componentWillLoad;\n    Proto.componentWillLoad = function () {\n        var _this = this;\n        var el = getElement(this);\n        var onOpen = createDeferredPromise();\n        var event = new CustomEvent('openWormhole', {\n            bubbles: true,\n            composed: true,\n            detail: {\n                consumer: this,\n                fields: props,\n                updater: function (prop, value) {\n                    var target = (prop in el) ? el : _this;\n                    target[prop] = value;\n                },\n                onOpen: onOpen,\n            },\n        });\n        el.dispatchEvent(event);\n        var willLoad = function () {\n            if (componentWillLoad) {\n                return componentWillLoad.call(_this);\n            }\n        };\n        return isBlocking ? onOpen.promise.then(function () { return willLoad(); }) : (willLoad());\n    };\n};\n\nexport { openWormhole as o };\n","import { r as registerInstance, c as createEvent, h, g as getElement } from './index-430bb51b.js';\nimport { _ as __ } from './default-i18n-c67eee5a.js';\nimport { o as openWormhole } from './consumer-1db89974.js';\nimport './_commonjsHelpers-9943807e.js';\n\nconst scDonationChoicesCss = \":host{display:block}.sc-donation-choices{display:grid;gap:var(--sc-spacing-small);position:relative}.sc-donation-choices__form{display:grid;gap:var(--sc-spacing-small)}\";\n\nconst ScDonationChoices = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.scRemoveLineItem = createEvent(this, \"scRemoveLineItem\", 7);\n    this.scUpdateLineItem = createEvent(this, \"scUpdateLineItem\", 7);\n    this.scAddLineItem = createEvent(this, \"scAddLineItem\", 7);\n    /** Currency code for the donation. */\n    this.currencyCode = 'usd';\n    /** Order line items. */\n    this.lineItems = [];\n    this.removeInvalid = true;\n  }\n  async reportValidity() {\n    if (!this.input)\n      return true;\n    return this.input.shadowRoot.querySelector('sc-input').reportValidity();\n  }\n  handleChange() {\n    const checked = Array.from(this.getChoices()).find(item => item.checked);\n    this.showCustomAmount = checked.value === 'ad_hoc';\n    if (!isNaN(parseInt(checked.value))) {\n      this.scUpdateLineItem.emit({ price_id: this.priceId, quantity: 1, ad_hoc_amount: parseInt(checked.value) });\n    }\n  }\n  handleCustomAmountToggle(val) {\n    if (val) {\n      setTimeout(() => {\n        this.input.triggerFocus();\n      }, 50);\n    }\n  }\n  /** Store current line item in state. */\n  handleLineItemsChange() {\n    var _a;\n    if (!((_a = this.lineItems) === null || _a === void 0 ? void 0 : _a.length))\n      return;\n    this.lineItem = (this.lineItems || []).find(lineItem => lineItem.price.id === this.priceId);\n  }\n  handleLineItemChange(val) {\n    this.removeInvalid && this.removeInvalidPrices();\n    const choices = this.getChoices();\n    let hasCheckedOption = false;\n    // check the correct option.\n    choices.forEach((el) => {\n      if (isNaN(parseInt(el.value)) || el.disabled)\n        return;\n      if (parseInt(el.value) === (val === null || val === void 0 ? void 0 : val.ad_hoc_amount)) {\n        el.checked = true;\n        hasCheckedOption = true;\n      }\n      else {\n        el.checked = false;\n      }\n    });\n    this.showCustomAmount = !hasCheckedOption;\n    // no options are checked, let's fill in the input.\n    if (!hasCheckedOption) {\n      this.el.querySelector('sc-choice[value=\"ad_hoc\"]').checked = true;\n    }\n  }\n  componentDidLoad() {\n    this.handleLineItemsChange();\n  }\n  selectDefaultChoice() {\n    const choices = this.getChoices();\n    if (!choices.length)\n      return;\n    choices[0].checked = true;\n  }\n  getChoices() {\n    return this.el.querySelectorAll('sc-choice');\n  }\n  removeInvalidPrices() {\n    var _a, _b, _c;\n    if (!this.lineItem)\n      return;\n    // bail if no min or max.\n    if (!((_a = this.lineItem.price) === null || _a === void 0 ? void 0 : _a.ad_hoc_min_amount) && !((_c = (_b = this.lineItem) === null || _b === void 0 ? void 0 : _b.price) === null || _c === void 0 ? void 0 : _c.ad_hoc_min_amount)) {\n      return;\n    }\n    const choices = this.el.querySelectorAll('sc-choice');\n    choices.forEach((el) => {\n      var _a, _b, _c, _d;\n      if (parseInt(el.value) > ((_b = (_a = this.lineItem) === null || _a === void 0 ? void 0 : _a.price) === null || _b === void 0 ? void 0 : _b.ad_hoc_max_amount) || parseInt(el.value) < ((_d = (_c = this.lineItem) === null || _c === void 0 ? void 0 : _c.price) === null || _d === void 0 ? void 0 : _d.ad_hoc_min_amount)) {\n        el.style.display = 'none';\n        el.disabled = true;\n      }\n      else {\n        el.style.display = 'flex';\n        el.disabled = false;\n      }\n    });\n  }\n  updateCustomAmount() {\n    var _a;\n    if (this.input.value === ((_a = this.lineItem) === null || _a === void 0 ? void 0 : _a.ad_hoc_amount.toString()))\n      return;\n    this.input.value\n      ? this.scUpdateLineItem.emit({ price_id: this.priceId, quantity: 1, ad_hoc_amount: parseInt(this.input.value) })\n      : this.scRemoveLineItem.emit({ price_id: this.priceId, quantity: 1 });\n  }\n  render() {\n    var _a;\n    if (this.loading) {\n      return (h(\"div\", { class: \"sc-donation-choices\" }, h(\"sc-skeleton\", { style: { width: '20%', display: 'inline-block' } }), h(\"sc-skeleton\", { style: { width: '60%', display: 'inline-block' } }), h(\"sc-skeleton\", { style: { width: '40%', display: 'inline-block' } })));\n    }\n    return (h(\"div\", { class: \"sc-donation-choices\" }, h(\"sc-choices\", { label: this.label, \"auto-width\": true }, h(\"slot\", null)), this.showCustomAmount && (h(\"div\", { class: \"sc-donation-choices__form\" }, h(\"sc-price-input\", { ref: el => (this.input = el), required: true, currencyCode: this.currencyCode, label: 'Enter an amount', value: (_a = this.lineItem) === null || _a === void 0 ? void 0 : _a.ad_hoc_amount.toString() }), h(\"sc-button\", { type: \"primary\", onClick: () => this.updateCustomAmount(), full: true, busy: this.busy }, __('Update', 'surecart')))), this.busy && h(\"sc-block-ui\", { style: { zIndex: '9' } })));\n  }\n  get el() { return getElement(this); }\n  static get watchers() { return {\n    \"showCustomAmount\": [\"handleCustomAmountToggle\"],\n    \"lineItems\": [\"handleLineItemsChange\"],\n    \"lineItem\": [\"handleLineItemChange\"]\n  }; }\n};\nopenWormhole(ScDonationChoices, ['lineItems', 'loading', 'busy', 'currencyCode'], false);\nScDonationChoices.style = scDonationChoicesCss;\n\nexport { ScDonationChoices as sc_donation_choices };\n"],"names":["openWormhole","Component","props","isBlocking","Proto","constructor","name","prototype","componentWillLoad","resolve","_this","this","el","g","onOpen","promise","Promise","res","event","CustomEvent","bubbles","composed","detail","consumer","fields","updater","prop","value","dispatchEvent","willLoad","call","then","ScDonationChoices","hostRef","r","scRemoveLineItem","c","scUpdateLineItem","scAddLineItem","currencyCode","lineItems","removeInvalid","async","input","shadowRoot","querySelector","reportValidity","handleChange","checked","Array","from","getChoices","find","item","showCustomAmount","isNaN","parseInt","emit","price_id","priceId","quantity","ad_hoc_amount","handleCustomAmountToggle","val","setTimeout","triggerFocus","handleLineItemsChange","_a","length","lineItem","price","id","handleLineItemChange","removeInvalidPrices","choices","hasCheckedOption","forEach","disabled","componentDidLoad","selectDefaultChoice","querySelectorAll","_b","_c","ad_hoc_min_amount","_d","ad_hoc_max_amount","style","display","updateCustomAmount","toString","render","loading","h","class","width","label","ref","required","type","onClick","full","busy","_","zIndex","watchers","o"],"sourceRoot":""}