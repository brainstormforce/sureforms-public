{"version":3,"file":"6022.js","mappings":"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","sources":["webpack://sureforms/./node_modules/@surecart/components/dist/esm/consumer-1db89974.js","webpack://sureforms/./node_modules/@surecart/components/dist/esm/sc-custom-order-price-input.entry.js"],"sourcesContent":["import { g as getElement } from './index-430bb51b.js';\n\nvar createDeferredPromise = function () {\n    var resolve;\n    var promise = new Promise(function (res) { resolve = res; });\n    return { promise: promise, resolve: resolve };\n};\n\nvar openWormhole = function (Component, props, isBlocking) {\n    if (isBlocking === void 0) { isBlocking = true; }\n    var isConstructor = (Component.constructor.name === 'Function');\n    var Proto = isConstructor ? Component.prototype : Component;\n    var componentWillLoad = Proto.componentWillLoad;\n    Proto.componentWillLoad = function () {\n        var _this = this;\n        var el = getElement(this);\n        var onOpen = createDeferredPromise();\n        var event = new CustomEvent('openWormhole', {\n            bubbles: true,\n            composed: true,\n            detail: {\n                consumer: this,\n                fields: props,\n                updater: function (prop, value) {\n                    var target = (prop in el) ? el : _this;\n                    target[prop] = value;\n                },\n                onOpen: onOpen,\n            },\n        });\n        el.dispatchEvent(event);\n        var willLoad = function () {\n            if (componentWillLoad) {\n                return componentWillLoad.call(_this);\n            }\n        };\n        return isBlocking ? onOpen.promise.then(function () { return willLoad(); }) : (willLoad());\n    };\n};\n\nexport { openWormhole as o };\n","import { r as registerInstance, c as createEvent, h } from './index-430bb51b.js';\nimport { a as apiFetch } from './fetch-d56a3ec0.js';\nimport { o as openWormhole } from './consumer-1db89974.js';\nimport './default-i18n-c67eee5a.js';\nimport './_commonjsHelpers-9943807e.js';\nimport './add-query-args-f4c5962b.js';\n\nconst scCustomOrderPriceInputCss = \"sc-custom-order-price-input{display:block}\";\n\nconst ScCustomOrderPriceInput = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.scUpdateLineItem = createEvent(this, \"scUpdateLineItem\", 7);\n    /** Is this loading */\n    this.loading = false;\n    /** Is this busy */\n    this.busy = false;\n    /** Label for the choice. */\n    this.lineItems = [];\n    /** Internal fetching state. */\n    this.fetching = false;\n  }\n  handleBlur(e) {\n    var _a;\n    const ad_hoc_amount = parseInt(e.target.value);\n    if (isNaN(ad_hoc_amount))\n      return;\n    if (((_a = this.lineItem) === null || _a === void 0 ? void 0 : _a.ad_hoc_amount) === ad_hoc_amount)\n      return;\n    this.scUpdateLineItem.emit({ price_id: this.priceId, quantity: 1, ad_hoc_amount });\n  }\n  /** Store current line item in state. */\n  handleLineItemsChange() {\n    var _a;\n    if (!((_a = this.lineItems) === null || _a === void 0 ? void 0 : _a.length))\n      return;\n    this.lineItem = (this.lineItems || []).find(lineItem => lineItem.price.id === this.priceId);\n  }\n  componentDidLoad() {\n    if (!this.price) {\n      this.fetchPrice();\n    }\n  }\n  /** Fetch prices and products */\n  async fetchPrice() {\n    if (!this.priceId)\n      return;\n    try {\n      this.fetching = true;\n      this.price = (await apiFetch({\n        path: `surecart/v1/prices/${this.priceId}`,\n      }));\n    }\n    catch (err) {\n    }\n    finally {\n      this.fetching = false;\n    }\n  }\n  render() {\n    var _a, _b, _c, _d;\n    if (this.loading || this.fetching) {\n      return (h(\"div\", null, h(\"sc-skeleton\", { style: { width: '20%', marginBottom: '0.75em' } }), h(\"sc-skeleton\", { style: { width: '100%' } })));\n    }\n    return (h(\"div\", { class: \"sc-custom-order-price-input\" }, h(\"sc-price-input\", { \"currency-code\": ((_a = this.price) === null || _a === void 0 ? void 0 : _a.currency) || 'usd', label: this.label, min: (_b = this === null || this === void 0 ? void 0 : this.price) === null || _b === void 0 ? void 0 : _b.ad_hoc_min_amount, max: (_c = this === null || this === void 0 ? void 0 : this.price) === null || _c === void 0 ? void 0 : _c.ad_hoc_max_amount, placeholder: this.placeholder, required: this.required, value: (_d = this.lineItem) === null || _d === void 0 ? void 0 : _d.ad_hoc_amount.toString(), \"show-code\": this.showCode, help: this.help }), this.busy && h(\"sc-block-ui\", { style: { zIndex: '9' } })));\n  }\n  static get watchers() { return {\n    \"lineItems\": [\"handleLineItemsChange\"]\n  }; }\n};\nopenWormhole(ScCustomOrderPriceInput, ['busy', 'lineItems'], false);\nScCustomOrderPriceInput.style = scCustomOrderPriceInputCss;\n\nexport { ScCustomOrderPriceInput as sc_custom_order_price_input };\n"],"names":["openWormhole","Component","props","isBlocking","Proto","constructor","name","prototype","componentWillLoad","resolve","_this","this","el","g","onOpen","promise","Promise","res","event","CustomEvent","bubbles","composed","detail","consumer","fields","updater","prop","value","dispatchEvent","willLoad","call","then","ScCustomOrderPriceInput","hostRef","r","scUpdateLineItem","c","loading","busy","lineItems","fetching","handleBlur","e","_a","ad_hoc_amount","parseInt","target","isNaN","lineItem","emit","price_id","priceId","quantity","handleLineItemsChange","length","find","price","id","componentDidLoad","fetchPrice","async","a","path","err","render","_b","_c","_d","h","style","width","marginBottom","class","currency","label","min","ad_hoc_min_amount","max","ad_hoc_max_amount","placeholder","required","toString","showCode","help","zIndex","watchers","o"],"sourceRoot":""}