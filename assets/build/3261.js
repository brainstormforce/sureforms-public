"use strict";(self.webpackChunksureforms=self.webpackChunksureforms||[]).push([[3261],{3261:function(t,s,i){i.r(s),i.d(s,{sc_subscription_cancel:function(){return c}});var e=i(6046),r=i(290),n=i(712),o=i(8517);i(5115);const c=class{constructor(t){(0,e.r)(this,t)}componentWillLoad(){this.fetchItems()}async fetchItems(){try{this.loading=!0,await Promise.all([this.fetchProtocol(),this.fetchSubscription()])}catch(t){console.error(this.error),this.error=(null==t?void 0:t.message)||(0,r._)("Something went wrong","surecart")}finally{this.loading=!1}}async fetchProtocol(){this.protocol=await(0,n.a)({path:"/surecart/v1/subscription_protocol"})}async fetchSubscription(){this.subscriptionId&&(this.subscription=await(0,n.a)({path:(0,o.a)(`/surecart/v1/subscriptions/${this.subscriptionId}`,{expand:["price","price.product","latest_invoice","product"]})}))}async cancelSubscription(){try{this.error="",this.busy=!0,await(0,n.a)({path:`/surecart/v1/subscriptions/${this.subscriptionId}/cancel`,method:"PATCH"}),this.successUrl?window.location.assign(this.successUrl):this.busy=!1}catch(t){this.error=(null==t?void 0:t.message)||(0,r._)("Something went wrong","surecart"),this.busy=!1}}renderContent(){var t,s;return this.loading?this.renderLoading():(0,e.h)(e.F,null,(0,e.h)("sc-subscription-details",{subscription:null==this?void 0:this.subscription,hideRenewalText:!0}),"pending"===(null===(t=null==this?void 0:this.protocol)||void 0===t?void 0:t.cancel_behavior)?(0,e.h)("sc-alert",{type:"info",open:!0},(0,r._)("Your plan will be canceled, but is still available until the end of your billing period on","surecart")," ",(0,e.h)("strong",null,(0,e.h)("sc-format-date",{type:"timestamp",date:null===(s=null==this?void 0:this.subscription)||void 0===s?void 0:s.current_period_end_at,month:"long",day:"numeric",year:"numeric"})),". ",(0,r._)("If you change your mind, you can renew your subscription.","surecart")):(0,e.h)("sc-alert",{type:"info",open:!0},(0,r._)("Your plan will be canceled immediately. You cannot change your mind.","surecart")))}renderLoading(){return(0,e.h)("div",{style:{padding:"0.5em"}},(0,e.h)("sc-skeleton",{style:{width:"30%",marginBottom:"0.75em"}}),(0,e.h)("sc-skeleton",{style:{width:"20%",marginBottom:"0.75em"}}),(0,e.h)("sc-skeleton",{style:{width:"40%"}}))}render(){return(0,e.h)("sc-dashboard-module",{heading:this.heading||(0,r._)("Cancel your plan","surecart"),class:"subscription-cancel",error:this.error},(0,e.h)("sc-card",null,this.renderContent(),(0,e.h)("sc-button",{type:"primary",full:!0,loading:this.loading||this.busy,disabled:this.loading||this.busy,onClick:()=>this.cancelSubscription()},(0,r._)("Cancel Plan","surecart")),!!this.backUrl&&(0,e.h)("sc-button",{href:this.backUrl,full:!0,loading:this.loading||this.busy,disabled:this.loading||this.busy},(0,r._)("Go Back","surecart"))),this.busy&&(0,e.h)("sc-block-ui",null))}};c.style=":host{display:block;position:relative}.subscription-cancel{display:grid;gap:0.5em}"}}]);
//# sourceMappingURL=3261.js.map