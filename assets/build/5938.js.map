{"version":3,"file":"5938.js","mappings":"4IACA,MAAMA,EAAiB,CAACC,EAAIC,KACG,IAAIC,OAAOC,sBAAqB,CAACC,EAASC,KACjED,EAAQ,GAAGE,kBAAoB,IACjCL,IACAI,EAASE,UAAUH,EAAQ,GAAGI,QAChC,IAEmBC,QAAQT,EAAG,C,oJCDlC,MAEMU,EAAkB,MACtBC,YAAYC,IACV,IAAAC,GAAiBC,KAAMF,GAEvBE,KAAKC,MAAQ,CACXC,KAAM,EACNC,SAAU,IAEZH,KAAKI,UAAY,GACjBJ,KAAKK,WAAa,CAChBC,MAAO,EACPC,YAAa,EAEjB,CACAC,qBACE,IAAAC,GAAeT,KAAKd,IAAI,KACtBc,KAAKU,cAAc,GAEvB,CACAC,qBACE,IACEX,KAAKY,SAAU,QACTZ,KAAKa,UACb,CACA,MAAOC,GACLC,QAAQC,MAAMhB,KAAKgB,OACnBhB,KAAKgB,OAASF,aAA6B,EAASA,EAAEG,WAAY,IAAAC,GAAG,uBAAwB,WAC/F,CACA,QACElB,KAAKY,SAAU,CACjB,CACF,CACAD,mBACE,IACEX,KAAKmB,MAAO,QACNnB,KAAKa,UACb,CACA,MAAOC,GACLC,QAAQC,MAAMhB,KAAKgB,OACnBhB,KAAKgB,OAASF,aAA6B,EAASA,EAAEG,WAAY,IAAAC,GAAG,uBAAwB,WAC/F,CACA,QACElB,KAAKmB,MAAO,CACd,CACF,CAEAR,iBACE,MAAMS,cAAwB,IAAAC,GAAS,CACrCC,MAAM,IAAAD,GAAa,yBAA0B,CAC3CE,OAAQ,CAAC,UAAW,iBACpBC,cAAc,EACdC,SAAS,KACNzB,KAAKC,QAEVyB,OAAO,IAOT,OALA1B,KAAKK,WAAa,CAChBC,MAAOqB,SAASP,EAASQ,QAAQC,IAAI,eACrCtB,YAAaoB,SAASP,EAASQ,QAAQC,IAAI,qBAE7C7B,KAAKI,gBAAmBgB,EAASU,OAC1B9B,KAAKI,SACd,CACA2B,WACE/B,KAAKC,MAAMC,KAAOF,KAAKC,MAAMC,KAAO,EACpCF,KAAKgC,YACP,CACAC,WACEjC,KAAKC,MAAMC,KAAOF,KAAKC,MAAMC,KAAO,EACpCF,KAAKgC,YACP,CACAE,SACE,IAAIC,EACJ,OAAQ,IAAAC,GAAE,oBAAqB,CAAEC,QAASrC,KAAKqC,QAASC,QAAStC,KAAKsC,SAAWtC,KAAKK,WAAWE,YAAc,EAAIP,KAAKsC,QAAU,GAAI1B,QAASZ,KAAKY,QAASO,KAAMnB,KAAKmB,KAAMoB,aAAcvC,KAAKuC,aAAcvB,MAAOhB,KAAKgB,MAAOZ,UAAWJ,KAAKI,YAAa,IAAAgC,GAAE,OAAQ,CAAEI,KAAM,YAAa,IAAAJ,GAAE,OAAQ,CAAEK,KAAM,WAAazC,KAAKqC,UAAW,IAAAnB,GAAG,YAAa,eAAe,IAAAkB,GAAE,gBAAiB,CAAEI,KAAM,QAAStC,KAAMF,KAAKC,MAAMC,KAAMwC,QAAS1C,KAAKC,MAAME,SAAUG,MAAON,KAAKK,WAAWC,MAAOqC,WAAY3C,KAAKK,WAAWE,YAAaqC,aAAoF,QAArET,EAAKnC,gBAAmC,EAASA,KAAKI,iBAA8B,IAAP+B,OAAgB,EAASA,EAAGU,OAAQC,aAAc,IAAM9C,KAAK+B,WAAYgB,aAAc,IAAM/C,KAAKiC,aAC5sB,CACI/C,SAAO,OAAO,IAAA8D,GAAWhD,KAAO,GAEtCJ,EAAgBqD,MA/EoB,sD","sources":["webpack://sureforms/./node_modules/@surecart/components-react/node_modules/@surecart/components/dist/esm/lazy-64c2bf3b.js","webpack://sureforms/./node_modules/@surecart/components-react/node_modules/@surecart/components/dist/esm/sc-dashboard-downloads-list.entry.js"],"sourcesContent":["/** Do something the first time the element is visible */\nconst onFirstVisible = (el, callback) => {\n  const intersectionObserver = new window.IntersectionObserver((entries, observer) => {\n    if (entries[0].intersectionRatio > 0) {\n      callback();\n      observer.unobserve(entries[0].target);\n    }\n  });\n  intersectionObserver.observe(el);\n};\n\nexport { onFirstVisible as o };\n","import { r as registerInstance, h, g as getElement } from './index-430bb51b.js';\nimport { _ as __ } from './default-i18n-c67eee5a.js';\nimport { a as apiFetch } from './fetch-d56a3ec0.js';\nimport { o as onFirstVisible } from './lazy-64c2bf3b.js';\nimport { a as addQueryArgs } from './add-query-args-f4c5962b.js';\nimport './_commonjsHelpers-9943807e.js';\n\nconst scDashboardDownloadsListCss = \":host{display:block}.download__details{opacity:0.75}\";\n\nconst ScDownloadsList = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    /** Customer id to fetch subscriptions */\n    this.query = {\n      page: 1,\n      per_page: 10,\n    };\n    this.purchases = [];\n    this.pagination = {\n      total: 0,\n      total_pages: 0,\n    };\n  }\n  componentWillLoad() {\n    onFirstVisible(this.el, () => {\n      this.initialFetch();\n    });\n  }\n  async initialFetch() {\n    try {\n      this.loading = true;\n      await this.getItems();\n    }\n    catch (e) {\n      console.error(this.error);\n      this.error = (e === null || e === void 0 ? void 0 : e.message) || __('Something went wrong', 'surecart');\n    }\n    finally {\n      this.loading = false;\n    }\n  }\n  async fetchItems() {\n    try {\n      this.busy = true;\n      await this.getItems();\n    }\n    catch (e) {\n      console.error(this.error);\n      this.error = (e === null || e === void 0 ? void 0 : e.message) || __('Something went wrong', 'surecart');\n    }\n    finally {\n      this.busy = false;\n    }\n  }\n  /** Get all subscriptions */\n  async getItems() {\n    const response = (await await apiFetch({\n      path: addQueryArgs(`surecart/v1/purchases/`, {\n        expand: ['product', 'product.files'],\n        downloadable: true,\n        revoked: false,\n        ...this.query,\n      }),\n      parse: false,\n    }));\n    this.pagination = {\n      total: parseInt(response.headers.get('X-WP-Total')),\n      total_pages: parseInt(response.headers.get('X-WP-TotalPages')),\n    };\n    this.purchases = (await response.json());\n    return this.purchases;\n  }\n  nextPage() {\n    this.query.page = this.query.page + 1;\n    this.fetchItems();\n  }\n  prevPage() {\n    this.query.page = this.query.page - 1;\n    this.fetchItems();\n  }\n  render() {\n    var _a;\n    return (h(\"sc-downloads-list\", { heading: this.heading, allLink: this.allLink && this.pagination.total_pages > 1 ? this.allLink : '', loading: this.loading, busy: this.busy, requestNonce: this.requestNonce, error: this.error, purchases: this.purchases }, h(\"span\", { slot: \"heading\" }, h(\"slot\", { name: \"heading\" }, this.heading || __('Downloads', 'surecart'))), h(\"sc-pagination\", { slot: \"after\", page: this.query.page, perPage: this.query.per_page, total: this.pagination.total, totalPages: this.pagination.total_pages, totalShowing: (_a = this === null || this === void 0 ? void 0 : this.purchases) === null || _a === void 0 ? void 0 : _a.length, onScNextPage: () => this.nextPage(), onScPrevPage: () => this.prevPage() })));\n  }\n  get el() { return getElement(this); }\n};\nScDownloadsList.style = scDashboardDownloadsListCss;\n\nexport { ScDownloadsList as sc_dashboard_downloads_list };\n"],"names":["onFirstVisible","el","callback","window","IntersectionObserver","entries","observer","intersectionRatio","unobserve","target","observe","ScDownloadsList","constructor","hostRef","r","this","query","page","per_page","purchases","pagination","total","total_pages","componentWillLoad","o","initialFetch","async","loading","getItems","e","console","error","message","_","busy","response","a","path","expand","downloadable","revoked","parse","parseInt","headers","get","json","nextPage","fetchItems","prevPage","render","_a","h","heading","allLink","requestNonce","slot","name","perPage","totalPages","totalShowing","length","onScNextPage","onScPrevPage","g","style"],"sourceRoot":""}